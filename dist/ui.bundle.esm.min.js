function F(n,t=window.document){t.readyState==="interactive"||t.readyState==="complete"?n():t.addEventListener("DOMContentLoaded",n)}function R(n){return n.replace(/[&<"']/g,function(t){return{"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"}[t]})}function B(n,t){n.disabled=!0,n.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+R(t)}function k(n,t){n.disabled=!1,n.innerText=t}function I(n,t){n.disabled=!1,n.innerHTML=t}function j(n){n.scrollTop=0}function H(n){n.scrollTop=n.scrollHeight}function U(...n){for(let t=0;t<n.length;t++)n[t].classList.add("d-none")}function q(...n){for(let t=0;t<n.length;t++)n[t].classList.remove("d-none")}function N(n,t=null,e=window.document){if(n.getElementsByClassName("spinner-border")[0])return;let r=e.createElement("span");t?r.className=t:r.className="spinner-border spinner-border-sm",n.prepend(r)}function G(n){let t=n.querySelector(".spinner-border");t&&t.remove()}function X(n=window){return!!(n.matchMedia&&n.matchMedia("(prefers-color-scheme: dark)").matches)}function K(){let n=navigator.language.match(/^[a-z]+/);return n?n[0]:"en"}function W(n,t=2,e,r){e=e||"en",r=r||{en:["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"]};let o=r[e]?r[e]:r.en;if(n===0)return"0 "+o[0];let s=n<0?"-":"";n=Math.abs(n);let i=1024,l=t<0?0:t,f=Math.floor(Math.log(n)/Math.log(i));return s+parseFloat((n/Math.pow(i,f)).toFixed(l))+" "+o[f]}function Y(n){return navigator.clipboard.writeText(n)}function Z(n,t=400,e=window){n.style.opacity="0",n.style.display="block";let r=+new Date,o=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity+(s-r)/t),r=+new Date,+n.style.opacity<1&&(e.requestAnimationFrame&&e.requestAnimationFrame(o)||setTimeout(o,16))};o()}function J(n,t=400,e=window){n.style.opacity="1";let r=+new Date,o=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity-(s-r)/t),r=+new Date,+n.style.opacity>0&&(e.requestAnimationFrame&&e.requestAnimationFrame(o)||setTimeout(o,16))};o()}function Q(n){return new Promise(t=>setTimeout(t,n))}function V(n,t){return new Promise((e,r)=>{let o=Date.now(),s=!1,i=!1,l,f,h=setTimeout(()=>{i=!0,s&&(f?r(f):e(l))},t);n.then(a=>{l=a,s=!0,Date.now()-o>=t&&i&&e(a)}).catch(a=>{f=a,s=!0,Date.now()-o>=t&&i&&r(a)})})}function tt(n){var t=new Date(n*1e3);return`${t.toLocaleDateString("en-GB")} ${t.toLocaleTimeString("en-GB")}`}function et(n){var t=new Date(n*1e3);return`${t.toLocaleDateString("en-GB")}`}function nt(n=new Date){return Math.floor(n.getTime()/1e3)}var y=class{items=new Map;#t="";addItem(t,e,r){if(this.items.has(t))throw new Error("Item already exists");this.items.set(t,{isActive:!1,on:e,off:r})}removeItem(t){this.#t===t&&(this.#t=""),this.items.delete(t)}setActive(t){if(!this.items.has(t))throw new Error("Item not found");if(this.#t!==t)for(let[e,r]of this.items)e===t?(this.#t=e,r.isActive||(r.isActive=!0,r.on(e))):(r.isActive&&r.off(e),r.isActive=!1)}runCallbacks(){for(let[t,e]of this.items)e.isActive?e.on(t):e.off(t)}init(t){this.setActive(t),this.runCallbacks()}};function M(n=window.document){if(!n)throw new Error("Document is null. Cannot inject core styles.");let t=`
.d-none {
    display: none !important;
}

html-fragment {
    display: contents;
}
`,e=new CSSStyleSheet;e.replaceSync(t),n.adoptedStyleSheets=[...n.adoptedStyleSheets,e]}var $="data-scope",A="unnamed-scope",D="data-ref",m=class{ref_attr_name;scope_ref_attr_name;window;isScopeElement;includeRoot;scope_auto_name_prefix;constructor(){this.ref_attr_name=D,this.scope_ref_attr_name=$,this.window=globalThis.window,this.isScopeElement=null,this.includeRoot=!1,this.scope_auto_name_prefix=A}toString(){return`ScopeConfig(ref_attr_name=${this.ref_attr_name}, scope_ref_attr_name=${this.scope_ref_attr_name}, includeRoot=${this.includeRoot}, scope_auto_name_prefix=${this.scope_auto_name_prefix}, window=${this.window?"defined":"undefined"}, isScopeElement=${this.isScopeElement})`}},u=new m;function v(n,t){var e=null;t||(t=u);let r=t.scope_ref_attr_name||$,o=t.isScopeElement;return o?e=o(n,t):e=n.getAttribute(r),e===null?null:e}function g(n={}){let t=new m;return t.includeRoot=n.hasOwnProperty("includeRoot")&&typeof n.includeRoot<"u"?n.includeRoot:u.includeRoot,t.scope_auto_name_prefix=n.hasOwnProperty("scope_auto_name_prefix")&&typeof n.scope_auto_name_prefix=="string"?n.scope_auto_name_prefix:u.scope_auto_name_prefix,t.isScopeElement=n.hasOwnProperty("isScopeElement")&&typeof n.isScopeElement<"u"?n.isScopeElement:u.isScopeElement,t.ref_attr_name=n.hasOwnProperty("ref_attr_name")&&typeof n.ref_attr_name=="string"?n.ref_attr_name:u.ref_attr_name,t.window=n.hasOwnProperty("window")&&typeof n.window<"u"?n.window:u.window,t.scope_ref_attr_name=n.hasOwnProperty("scope_ref_attr_name")&&typeof n.scope_ref_attr_name=="string"?n.scope_ref_attr_name:u.scope_ref_attr_name,t}function b(n,t,e={}){var r={},o={},s=[];let i=g(e);function l(a){var c=a.getAttribute(i.ref_attr_name);if(c!=null&&c!=""&&(r[c]?globalThis.window?console.warn(`Element has reference #${c} which is already used
`,`
element: `,a,`
reference #${c}: `,r[c],`
scope root: `,n):console.warn(`Element has reference #${c} which is already used
`):r[c]=a),a!=n){var p=v(a,i);if(typeof p!="string")return;p!=""?o[p]?(console.warn(`scope #${p} is already used`,globalThis.window?a:""),s.push(a)):o[p]=a:s.push(a)}t&&t(a)}i.includeRoot===!0&&n instanceof i.window.HTMLElement&&(r.root=n,t&&t(n)),O(n,l,i);var f=0;let h=i.scope_auto_name_prefix;return s.forEach(a=>{for(;o[h+f.toString()];)f++;o[h+f.toString()]=a}),{refs:r,scope_refs:o}}function O(n,t,e){let r=g(e);function o(l){var f=l,h=f.parentElement;return h&&h!=n&&v(h,r)!==null?2:1}let s=r.window.document.createTreeWalker(n,1,o);var i;for(r.includeRoot===!0&&n instanceof r.window.HTMLElement&&t(n);i=s.nextNode();)t(i)}function T(n,t){for(let e in t){let r=n[e];if(!r)throw new Error(`Missing data-ref: ${e}`);let o=typeof t[e]=="function"?t[e].prototype:t[e];if(o.isPrototypeOf(r)===!1)throw new Error(`The data-ref "${e}" must be an instance of ${o.constructor.name} (actual: ${r.constructor.name})`)}}function S(n,t){if(typeof n!="string")throw new Error("html must be a string");let e=g(t);if(!e.window)throw new Error("window is not defined in options");let s=e.window.document.createElement("template");return s.innerHTML=n,s.content}var w=class{name;components=new Set;#t;constructor(t,e){this.name=t,this.#t=e}attach(t){t.$internals.parentComponent=this.#t,t.$internals.parentSlotName=this.name,this.components.add(t)}detach(t){t.$internals.parentComponent=null,t.$internals.parentSlotName="",this.components.delete(t)}detachAll(){this.components.forEach(t=>{t.$internals.parentComponent=null,t.$internals.parentSlotName=""}),this.components.clear()}mount(){if(!this.#t.isConnected){console.warn(`Cannot mount Slot "${this.name}" in disconnected component ${this.#t.constructor.name}`);return}let t=this.#t.$internals.slotRefs[this.name];if(!t){console.warn(`Cannot get root element for Slot "${this.name}" does not exist in component "${this.#t.constructor.name}"`);return}this.components.forEach(e=>{e.isCollapsed||e.mount(t,"append")})}unmount(){this.components.forEach(t=>{t.unmount()})}clear(){this.unmount(),this.detachAll()}};var _=class{slots=new Map;#t;constructor(t){this.#t=t}registerSlot(t){let e=this.getSlot(t);if(e!=null)return e;{let r=new w(t,this.#t);return this.slots.set(t,r),r}}getSlot(t){return this.slots.get(t)||null}hasSlot(t){return this.slots.has(t)}removeSlot(t){this.hasSlot(t)&&(this.clearSlotContent(t),this.slots.delete(t))}hasSlotContent(t){let e=this.getSlot(t);return e==null?!1:e.components.size>0}clearSlotContent(t){let e=this.getSlot(t);return e==null?!1:(e.clear(),!0)}get slotNames(){return Array.from(this.slots.keys())}mountAllSlots(){this.#t.isConnected&&this.slots.forEach(t=>{t.mount()})}mountSlot(t){let e=this.getSlot(t);if(!e){console.warn(`Slot "${t}" does not exist in component "${this.#t.constructor.name}"`);return}e.mount()}unmountAll(){for(let[t,e]of this.slots)e.unmount()}unmountSlot(t){let e=this.getSlot(t);e?.unmount()}attachToSlot(t,...e){let r=this.registerSlot(t);for(let o=0;o<e.length;o++){let s=e[o],i=this.findSlotByComponent(s);if(i!=null){console.warn(`Component ${s.constructor.name} is already assigned to slot ${i.name}.`);continue}r.attach(s)}return r}removeComponent(t){let e=this.findSlotByComponent(t);return e?(e.detach(t),t.unmount(),!0):!1}findSlotByComponent(t){return t.$internals.parentComponent!=this.#t?null:this.getSlot(t.$internals.parentSlotName)}};var d=class{events={};#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]};#e=!1;logErrors=!0;get isDestroyed(){return this.#e}on(t,e){if(this.#e)throw new Error("EventEmitter is destroyed");typeof this.events[t]!="object"&&(this.events[t]=[]),this.events[t].push(e);let r=this,o=function(){r.removeListener(t,e)};return this.events[t].length==1&&this.#r("#has-listeners",t),o}#n(t,e){this.#t[t].push(e);let r=this;return function(){r.#o(t,e)}}#o(t,e){var r;typeof this.#t[t]=="object"&&(r=this.#t[t].indexOf(e),r>-1&&this.#t[t].splice(r,1))}off(t,e){return this.removeListener(t,e)}removeListener(t,e){if(!this.#e){var r;this.events[t]&&(r=this.events[t].indexOf(e),r>-1&&(this.events[t].splice(r,1),this.events[t].length==0&&this.#r("#no-listeners",t)))}}emit(t,...e){if(!this.#e&&typeof this.events[t]=="object")for(var r=this.events[t],o=r.length,s=0;s<o;s++)try{r[s].apply(this,e)}catch(i){this.#r("#listener-error",i,t,...e),this.logErrors&&console.error(`Error in listener for event "${t}":`,i)}}#r(t,...e){for(var r=this.#t[t],o=r.length,s=0;s<o;s++)try{r[s].apply(this,e)}catch(i){let l=i;if(l.cause={event:t,args:e},t==="#listener-error"){this.logErrors&&console.error(`Error in listener for internal event "${t}":`,l);continue}t==="#has-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${t}":`,l),this.#r("#listener-error",l,"#has-listeners",...e)),t==="#no-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${t}":`,l),this.#r("#listener-error",l,"#no-listeners",...e))}}once(t,e){return this.on(t,function r(){this.removeListener(t,r),e.apply(this,arguments)})}waitForEvent(t,e=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let o,s=this.on(t,()=>{e>0&&clearTimeout(o),s(),r(!0)});e>0&&(o=setTimeout(()=>{s(),r(!1)},e))})}waitForAnyEvent(t,e=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let o,s=[],i=()=>{e>0&&clearTimeout(o),s.forEach(l=>{l()}),r(!0)};t.forEach(l=>{s.push(this.on(l,i))}),e>0&&(o=setTimeout(()=>{i(),r(!1)},e))})}clear(){this.events={}}destroy(){this.#e||(this.#e=!0,this.#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]},this.events={})}clearEventListeners(t){if(this.#e)return;(this.events[t]||[]).length>0&&(this.events[t]=[],this.#r("#no-listeners",t))}onHasEventListeners(t){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#has-listeners",t)}onNoEventListeners(t){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#no-listeners",t)}onListenerError(t){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#listener-error",t)}};var E=class{constructor(){this.eventEmitter=new d,this.disconnectController=new AbortController,this.root=null,this.textUpdateFunction=null,this.textResources={},this.refs={},this.slotRefs={},this.parentComponent=null,this.parentSlotName="",this.mountMode="replace"}};function L(n){n.reloadText();try{n.connectedCallback()}catch(t){console.error("Error in connectedCallback:",t)}}function P(n){try{n.disconnectedCallback()}catch(t){console.error("Error in disconnectedCallback:",t)}}var C=class{$internals=new E;#t=void 0;layout;refsAnnotation;#e=null;#n=!1;slotManager=new _(this);#o=!1;constructor(){this.onConnect(L),this.onDisconnect(P)}get isConnected(){return this.#n}get isCollapsed(){return this.#o}reloadText(){this.$internals.textUpdateFunction&&this.$internals.textUpdateFunction(this)}setTextUpdateFunction(t){this.$internals.textUpdateFunction=t}#r(){this.layout&&(this.#t=this.layout,this.layout=void 0);let t=this.#t||void 0;if(t==null)return;let e;if(typeof t=="function"){let o=t(this);o instanceof Node?e=o:e=S(o)}else e=S(t);let r=0;for(let o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType===1&&r++;if(r!==1)throw new Error("Layout must have exactly one root element");this.#e=e}setLayout(t,e){this.#t=t,this.#e=null,e&&(this.refsAnnotation=e)}setRenderer(t,e){this.setLayout(t,e)}getRefs(){if(!this.#n)throw new Error("Component is not connected to the DOM");return this.$internals.refs}getRef(t){let e=this.getRefs();if(!(t in e))throw new Error(`Ref "${t}" does not exist`);return e[t]}hasRef(t){let e=this.getRefs();return t in e}updateRefs(){if(!this.$internals.root)throw new Error("Component is not connected to the DOM");let t=this.$internals.root,{refs:e,scope_refs:r}=b(t,null,{scope_ref_attr_name:"data-slot",ref_attr_name:"data-ref"});this.refsAnnotation&&T(e,this.refsAnnotation);for(let o in r)this.slotManager.registerSlot(o);this.$internals.refs=e,this.$internals.slotRefs=r}on(t,e){return this.$internals.eventEmitter.on(t,e)}emit(t,...e){return this.$internals.eventEmitter.emit(t,this,...e)}$on(t,e,r){return t.addEventListener(e,r,{signal:this.$internals.disconnectController.signal}),()=>t.removeEventListener(e,r)}onBeforeConnect(t){return this.on("beforeConnect",t)}onConnect(t){return this.on("connect",t)}onDisconnect(t){return this.on("disconnect",t)}onMount(t){return this.on("mount",t)}onBeforeUnmount(t){return this.on("beforeUnmount",t)}onUnmount(t){return this.on("unmount",t)}onCollapse(t){return this.on("collapse",t)}onExpand(t){return this.on("expand",t)}connect(t){if(this.#n===!0)throw new Error("Component is already connected");this.$internals.root=t,this.updateRefs(),this.$internals.disconnectController=new AbortController,this.#n=!0,this.slotManager.mountAllSlots(),this.emit("connect")}disconnect(){this.#n!==!1&&(this.#n=!1,this.$internals.disconnectController.abort(),this.$internals.refs={},this.$internals.slotRefs={},this.emit("disconnect"))}connectedCallback(){}disconnectedCallback(){}mount(t,e="replace"){if(!(t instanceof Element))throw new TypeError("Container must be a DOM Element");let r=["replace","append","prepend"];if(!r.includes(e))throw new Error(`Invalid mode: ${e}. Must be one of: ${r.join(", ")}`);if(this.#e===null&&this.#r(),this.#e===null)throw new Error("Template is not set");if(this.$internals.mountMode=e,this.#n===!0)return;let o=this.#e.cloneNode(!0);this.emit("beforeConnect",o);let s=o.firstElementChild;e==="replace"?t.replaceChildren(o):e==="append"?t.append(o):e==="prepend"&&t.prepend(o),this.connect(s),this.emit("mount")}unmount(){this.#n!==!1&&(this.emit("beforeUnmount"),this.slotManager.unmountAll(),this.disconnect(),this.$internals.root?.remove(),this.emit("unmount"))}rerender(){let t=this.$internals.parentComponent||null;if(this.isConnected){let e=this.$internals.root.parentElement;this.unmount(),this.mount(e,this.$internals.mountMode)}else{if(t===null){console.error("Cannot rerender a disconnected component without a parent component");return}if(t.isConnected===!1){console.error("Cannot rerender a disconnected parent component");return}let e=t.$internals.slotRefs[this.$internals.parentSlotName]||null;if(!e){console.error("Cannot find a rendered slot with name "+this.$internals.parentSlotName+" in the parent component");return}this.mount(e,this.$internals.mountMode)}}update(){}show(){this.isConnected&&this.$internals.root?.classList.remove("d-none")}hide(){this.isConnected&&this.$internals.root?.classList.add("d-none")}collapse(){this.unmount(),this.#o=!0,this.emit("collapse")}expand(){this.#o=!1,this.#n!==!0&&this.$internals.parentComponent!==null&&(this.$internals.parentComponent.addComponentToSlot(this.$internals.parentSlotName,this),this.emit("expand"))}getSlotNames(){return this.slotManager.slotNames}addComponentToSlot(t,...e){let r=this.slotManager.attachToSlot(t,...e);this.#n&&r.mount()}getParentComponent(){return this.$internals.parentComponent||null}};var x=class{slotNames;activeSlotName;component;constructor(t,e,r){let o=t.slotManager;for(let s=0;s<e.length;s++)if(!o.hasSlot(e[s]))throw new Error(`Slot ${e[s]} does not exist in component`);this.component=t,this.slotNames=[...e],this.activeSlotName=r}toggle(t){if(this.slotNames.indexOf(t)===-1)throw new Error(`Slot ${t} is not defined in SlotToggler`);if(t!=this.activeSlotName)for(let e=0;e<this.slotNames.length;e++)this.slotNames[e]==t?(this.component.slotManager.mountSlot(t),this.activeSlotName=t):this.component.slotManager.unmountSlot(this.slotNames[e])}};export{C as Component,F as DOMReady,x as SlotToggler,y as Toggler,Y as copyToClipboard,R as escapeHtml,Z as fadeIn,J as fadeOut,W as formatBytes,et as formatDate,tt as formatDateTime,K as getDefaultLanguage,U as hideElements,M as injectCoreStyles,X as isDarkMode,G as removeSpinnerFromButton,H as scrollToBottom,j as scrollToTop,q as showElements,N as showSpinnerInButton,Q as sleep,k as ui_button_status_waiting_off,I as ui_button_status_waiting_off_html,B as ui_button_status_waiting_on,nt as unixtime,V as withMinimumTime};
