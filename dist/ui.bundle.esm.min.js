function F(n,e=window.document){e.readyState==="interactive"||e.readyState==="complete"?n():e.addEventListener("DOMContentLoaded",n)}function M(n){return n.replace(/[&<"']/g,function(e){return{"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})}function k(n,e){n.disabled=!0,n.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+M(e)}function B(n,e){n.disabled=!1,n.innerText=e}function I(n,e){n.disabled=!1,n.innerHTML=e}function j(n){n.scrollTop=0}function H(n){n.scrollTop=n.scrollHeight}function U(...n){for(let e=0;e<n.length;e++)n[e].classList.add("d-none")}function q(...n){for(let e=0;e<n.length;e++)n[e].classList.remove("d-none")}function G(n,e=null,t=window.document){if(n.getElementsByClassName("spinner-border")[0])return;let r=t.createElement("span");e?r.className=e:r.className="spinner-border spinner-border-sm",n.prepend(r)}function X(n){let e=n.querySelector(".spinner-border");e&&e.remove()}function K(n=window){return!!(n.matchMedia&&n.matchMedia("(prefers-color-scheme: dark)").matches)}function W(){let n=navigator.language.match(/^[a-z]+/);return n?n[0]:"en"}function Y(n,e=2,t,r){t=t||"en",r=r||{en:["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"]};let o=r[t]?r[t]:r.en;if(n===0)return"0 "+o[0];let s=n<0?"-":"";n=Math.abs(n);let i=1024,l=e<0?0:e,f=Math.floor(Math.log(n)/Math.log(i));return s+parseFloat((n/Math.pow(i,f)).toFixed(l))+" "+o[f]}function Z(n){return navigator.clipboard.writeText(n)}function J(n,e=400,t=window){n.style.opacity="0",n.style.display="block";let r=+new Date,o=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity+(s-r)/e),r=+new Date,+n.style.opacity<1&&(t.requestAnimationFrame&&t.requestAnimationFrame(o)||setTimeout(o,16))};o()}function Q(n,e=400,t=window){n.style.opacity="1";let r=+new Date,o=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity-(s-r)/e),r=+new Date,+n.style.opacity>0&&(t.requestAnimationFrame&&t.requestAnimationFrame(o)||setTimeout(o,16))};o()}function V(n){return new Promise(e=>setTimeout(e,n))}function z(n,e){return new Promise((t,r)=>{let o=Date.now(),s=!1,i=!1,l,f,h=setTimeout(()=>{i=!0,s&&(f?r(f):t(l))},e);n.then(a=>{l=a,s=!0,Date.now()-o>=e&&i&&t(a)}).catch(a=>{f=a,s=!0,Date.now()-o>=e&&i&&r(a)})})}function ee(n){var e=new Date(n*1e3);return`${e.toLocaleDateString("en-GB")} ${e.toLocaleTimeString("en-GB")}`}function te(n){var e=new Date(n*1e3);return`${e.toLocaleDateString("en-GB")}`}function ne(n=new Date){return Math.floor(n.getTime()/1e3)}var E=class{items=new Map;#t="";addItem(e,t,r){if(this.items.has(e))throw new Error("Item already exists");this.items.set(e,{isActive:!1,on:t,off:r})}removeItem(e){this.#t===e&&(this.#t=""),this.items.delete(e)}setActive(e){if(!this.items.has(e))throw new Error("Item not found");if(this.#t!==e)for(let[t,r]of this.items)t===e?(this.#t=t,r.isActive||(r.isActive=!0,r.on(t))):(r.isActive&&r.off(t),r.isActive=!1)}runCallbacks(){for(let[e,t]of this.items)t.isActive?t.on(e):t.off(e)}init(e){this.setActive(e),this.runCallbacks()}};function R(n=window.document){if(!n)throw new Error("Document is null. Cannot inject core styles.");let e=`
.d-none {
    display: none !important;
}

html-fragment {
    display: contents;
}
`,t=new CSSStyleSheet;t.replaceSync(e),n.adoptedStyleSheets=[...n.adoptedStyleSheets,t]}var v="data-scope",A="unnamed-scope",D="data-ref",m=class{ref_attr_name;scope_ref_attr_name;window;isScopeElement;includeRoot;scope_auto_name_prefix;constructor(){this.ref_attr_name=D,this.scope_ref_attr_name=v,this.window=globalThis.window,this.isScopeElement=null,this.includeRoot=!1,this.scope_auto_name_prefix=A}toString(){return`ScopeConfig(ref_attr_name=${this.ref_attr_name}, scope_ref_attr_name=${this.scope_ref_attr_name}, includeRoot=${this.includeRoot}, scope_auto_name_prefix=${this.scope_auto_name_prefix}, window=${this.window?"defined":"undefined"}, isScopeElement=${this.isScopeElement})`}},u=new m;function $(n,e){var t=null;e||(e=u);let r=e.scope_ref_attr_name||v,o=e.isScopeElement;return o?t=o(n,e):t=n.getAttribute(r),t===null?null:t}function y(n={}){let e=new m;return e.includeRoot=n.hasOwnProperty("includeRoot")&&typeof n.includeRoot<"u"?n.includeRoot:u.includeRoot,e.scope_auto_name_prefix=n.hasOwnProperty("scope_auto_name_prefix")&&typeof n.scope_auto_name_prefix=="string"?n.scope_auto_name_prefix:u.scope_auto_name_prefix,e.isScopeElement=n.hasOwnProperty("isScopeElement")&&typeof n.isScopeElement<"u"?n.isScopeElement:u.isScopeElement,e.ref_attr_name=n.hasOwnProperty("ref_attr_name")&&typeof n.ref_attr_name=="string"?n.ref_attr_name:u.ref_attr_name,e.window=n.hasOwnProperty("window")&&typeof n.window<"u"?n.window:u.window,e.scope_ref_attr_name=n.hasOwnProperty("scope_ref_attr_name")&&typeof n.scope_ref_attr_name=="string"?n.scope_ref_attr_name:u.scope_ref_attr_name,e}function b(n,e,t={}){var r={},o={},s=[];let i=y(t);function l(a){var c=a.getAttribute(i.ref_attr_name);if(c!=null&&c!=""&&(r[c]?globalThis.window?console.warn(`Element has reference #${c} which is already used
`,`
element: `,a,`
reference #${c}: `,r[c],`
scope root: `,n):console.warn(`Element has reference #${c} which is already used
`):r[c]=a),a!=n){var d=$(a,i);if(typeof d!="string")return;d!=""?o[d]?(console.warn(`scope #${d} is already used`,globalThis.window?a:""),s.push(a)):o[d]=a:s.push(a)}e&&e(a)}i.includeRoot===!0&&n instanceof i.window.HTMLElement&&(r.root=n,e&&e(n)),O(n,l,i);var f=0;let h=i.scope_auto_name_prefix;return s.forEach(a=>{for(;o[h+f.toString()];)f++;o[h+f.toString()]=a}),{refs:r,scope_refs:o}}function O(n,e,t){let r=y(t);function o(l){var f=l,h=f.parentElement;return h&&h!=n&&$(h,r)!==null?2:1}let s=r.window.document.createTreeWalker(n,1,o);var i;for(r.includeRoot===!0&&n instanceof r.window.HTMLElement&&e(n);i=s.nextNode();)e(i)}function T(n,e){for(let t in e){let r=n[t];if(!r)throw new Error(`Missing data-ref: ${t}`);let o=typeof e[t]=="function"?e[t].prototype:e[t];if(o.isPrototypeOf(r)===!1)throw new Error(`The data-ref "${t}" must be an instance of ${o.constructor.name} (actual: ${r.constructor.name})`)}}function g(n,e){if(typeof n!="string")throw new Error("html must be a string");let t=y(e);if(!t.window)throw new Error("window is not defined in options");let s=t.window.document.createElement("template");return s.innerHTML=n,s.content}var S=class{name;components=new Set;constructor(e){this.name=e}},w=class{#t=new Map;#e=new Set;#n;constructor(e){this.#n=e}addSlot(e){let t=this.getSlot(e);if(t!=null)return t;{let r=new S(e);return this.#t.set(e,r),r}}getSlot(e){return this.#t.get(e)||null}hasSlot(e){return this.#t.has(e)}removeSlot(e){this.hasSlot(e)&&(this.clearSlot(e),this.#t.delete(e))}hasComponents(e){let t=this.getSlot(e);return t==null?!1:t.components.size>0}clearSlot(e){let t=this.getSlot(e);return t==null?!1:(t.components.forEach(r=>{this.#n.removeChildComponent(r),r.unmount(),this.#e.delete(r)}),!0)}get slotNames(){return Array.from(this.#t.keys())}addComponentsToSlot(e,...t){let r=this.getSlot(e);r==null&&(r=this.addSlot(e));for(let o=0;o<t.length;o++)this.#e.has(t[o])||(this.#e.add(t[o]),r.components.add(t[o]))}get children(){return this.#e}mountChildren(){this.#n.isConnected&&this.#t.forEach(e=>{this.mountSlotComponents(e.name)})}mountSlotComponents(e){if(!this.#n.isConnected)return;let t=this.getSlot(e);if(!t){console.warn(`Slot "${e}" does not exist in component "${this.#n.constructor.name}"`);return}let r=this.#n.$internals.slotRefs[e];if(!r){console.warn(`Cannot get root element for Slot "${e}" does not exist in component "${this.#n.constructor.name}"`);return}t.components.forEach(o=>{o.isCollapsed||o.mount(r,"append")})}unmountComponents(){this.#e.forEach(e=>{e.unmount()})}unmountSlotComponents(e){let t=this.getSlot(e);t?.components.forEach(r=>{r.unmount()})}removeChildComponent(e){return this.#e.has(e)?(this.#e.delete(e),this.#t.forEach(t=>{t.components.delete(e)}),!0):!1}};var p=class{events={};#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]};#e=!1;logErrors=!0;get isDestroyed(){return this.#e}on(e,t){if(this.#e)throw new Error("EventEmitter is destroyed");typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(t);let r=this,o=function(){r.removeListener(e,t)};return this.events[e].length==1&&this.#r("#has-listeners",e),o}#n(e,t){this.#t[e].push(t);let r=this;return function(){r.#o(e,t)}}#o(e,t){var r;typeof this.#t[e]=="object"&&(r=this.#t[e].indexOf(t),r>-1&&this.#t[e].splice(r,1))}off(e,t){return this.removeListener(e,t)}removeListener(e,t){if(!this.#e){var r;this.events[e]&&(r=this.events[e].indexOf(t),r>-1&&(this.events[e].splice(r,1),this.events[e].length==0&&this.#r("#no-listeners",e)))}}emit(e,...t){if(!this.#e&&typeof this.events[e]=="object")for(var r=this.events[e],o=r.length,s=0;s<o;s++)try{r[s].apply(this,t)}catch(i){this.#r("#listener-error",i,e,...t),this.logErrors&&console.error(`Error in listener for event "${e}":`,i)}}#r(e,...t){for(var r=this.#t[e],o=r.length,s=0;s<o;s++)try{r[s].apply(this,t)}catch(i){let l=i;if(l.cause={event:e,args:t},e==="#listener-error"){this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l);continue}e==="#has-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l),this.#r("#listener-error",l,"#has-listeners",...t)),e==="#no-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l),this.#r("#listener-error",l,"#no-listeners",...t))}}once(e,t){return this.on(e,function r(){this.removeListener(e,r),t.apply(this,arguments)})}waitForEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let o,s=this.on(e,()=>{t>0&&clearTimeout(o),s(),r(!0)});t>0&&(o=setTimeout(()=>{s(),r(!1)},t))})}waitForAnyEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let o,s=[],i=()=>{t>0&&clearTimeout(o),s.forEach(l=>{l()}),r(!0)};e.forEach(l=>{s.push(this.on(l,i))}),t>0&&(o=setTimeout(()=>{i(),r(!1)},t))})}clear(){this.events={}}destroy(){this.#e||(this.#e=!0,this.#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]},this.events={})}clearEventListeners(e){if(this.#e)return;(this.events[e]||[]).length>0&&(this.events[e]=[],this.#r("#no-listeners",e))}onHasEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#has-listeners",e)}onNoEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#no-listeners",e)}onListenerError(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#listener-error",e)}};var _=class{constructor(){this.eventEmitter=new p,this.disconnectController=new AbortController,this.root=null,this.textUpdateFunction=null,this.textResources={},this.refs={},this.slotRefs={},this.parentComponent=null,this.parentSlotName=""}};function L(n){n.reloadText();try{n.connectedCallback()}catch(e){console.error("Error in connectedCallback:",e)}}function P(n){try{n.disconnectedCallback()}catch(e){console.error("Error in disconnectedCallback:",e)}}var x=class n{$internals=new _;#t=void 0;layout;slots;refsAnnotation;#e=null;#n=!1;slotManager=new w(this);isCollapsed=!1;constructor(){this.onConnect(L),this.onDisconnect(P)}reloadText(){this.$internals.textUpdateFunction&&this.$internals.textUpdateFunction(this)}setTextUpdateFunction(e){this.$internals.textUpdateFunction=e}#o(){this.layout&&(this.#t=this.layout,this.layout=void 0);let e=this.#t||void 0;if(e==null)return;let t;if(typeof e=="function"){let o=e(this);o instanceof Node?t=o:t=g(o)}else t=g(e);let r=0;for(let o=0;o<t.childNodes.length;o++)t.childNodes[o].nodeType===1&&r++;if(r!==1)throw new Error("Layout must have exactly one root element");this.#e=t}setLayout(e,t){this.#t=e,this.#e=null,t&&(this.refsAnnotation=t)}getRefs(){if(!this.#n)throw new Error("Component is not connected to the DOM");return this.$internals.refs}getRef(e){let t=this.getRefs();if(!(e in t))throw new Error(`Ref "${e}" does not exist`);return t[e]}hasRef(e){let t=this.getRefs();return e in t}updateRefs(){if(!this.$internals.root)throw new Error("Component is not connected to the DOM");let e=this.$internals.root,{refs:t,scope_refs:r}=b(e,null,{scope_ref_attr_name:"data-slot",ref_attr_name:"data-ref"});this.refsAnnotation&&T(t,this.refsAnnotation);for(let o in r)this.slotManager.addSlot(o);this.$internals.refs=t,this.$internals.slotRefs=r}on(e,t){return this.$internals.eventEmitter.on(e,t)}emit(e,...t){return this.$internals.eventEmitter.emit(e,this,...t)}onBeforeConnect(e){return this.on("beforeConnect",e)}onConnect(e){return this.on("connect",e)}onDisconnect(e){return this.on("disconnect",e)}onMount(e){return this.on("mount",e)}onBeforeUnmount(e){return this.on("beforeUnmount",e)}onUnmount(e){return this.on("unmount",e)}onCollapse(e){return this.on("collapse",e)}onExpand(e){return this.on("expand",e)}get isConnected(){return this.#n}connect(e){if(this.#n===!0)throw new Error("Component is already connected");this.$internals.root=e,this.updateRefs(),this.$internals.disconnectController=new AbortController,this.#n=!0,this.slotManager.mountChildren(),this.emit("connect")}disconnect(){this.#n!==!1&&(this.#n=!1,this.$internals.disconnectController.abort(),this.$internals.refs={},this.$internals.slotRefs={},this.emit("disconnect"))}connectedCallback(){}disconnectedCallback(){}mount(e,t="replace"){if(!(e instanceof Element))throw new TypeError("Container must be a DOM Element");let r=["replace","append","prepend"];if(!r.includes(t))throw new Error(`Invalid mode: ${t}. Must be one of: ${r.join(", ")}`);if(this.#e===null&&this.#o(),this.#e===null)throw new Error("Template is not set");if(this.#n===!0)return;let o=this.#e.cloneNode(!0);this.emit("beforeConnect",o);let s=o.firstElementChild;t==="replace"?e.replaceChildren(o):t==="append"?e.append(o):t==="prepend"&&e.prepend(o),this.connect(s),this.emit("mount")}unmount(){this.#n!==!1&&(this.emit("beforeUnmount"),this.slotManager.unmountComponents(),this.disconnect(),this.$internals.root?.remove(),this.emit("unmount"))}collapse(){this.unmount(),this.isCollapsed=!0,this.emit("collapse")}expand(){this.isCollapsed=!1,this.#n!==!0&&this.$internals.parentComponent!==null&&(this.$internals.parentComponent.addComponentToSlot(this.$internals.parentSlotName,this),this.emit("expand"))}show(){this.isConnected&&this.$internals.root?.classList.remove("d-none")}hide(){this.isConnected&&this.$internals.root?.classList.add("d-none")}$on(e,t,r){return e.addEventListener(t,r,{signal:this.$internals.disconnectController.signal}),()=>e.removeEventListener(t,r)}getSlotNames(){return this.slotManager.slotNames}addComponentToSlot(e,...t){if(!t.every(r=>r instanceof n))throw new Error("All components must be instances of Component");this.slotManager.addComponentsToSlot(e,...t);for(let r=0;r<t.length;r++)t[r].$internals.parentComponent=this,t[r].$internals.parentSlotName=e;this.#n&&this.slotManager.mountSlotComponents(e)}removeChildComponent(e){e.$internals.parentComponent===this&&(e.$internals.parentComponent=null,e.$internals.parentSlotName="",this.slotManager.removeChildComponent(e),e.unmount())}};var C=class{slotNames;activeSlotName;component;constructor(e,t,r){let o=e.slotManager;for(let s=0;s<t.length;s++)if(!o.hasSlot(t[s]))throw new Error(`Slot ${t[s]} does not exist in component`);this.component=e,this.slotNames=[...t],this.activeSlotName=r}toggle(e){if(this.slotNames.indexOf(e)===-1)throw new Error(`Slot ${e} is not defined in SlotToggler`);if(e!=this.activeSlotName)for(let t=0;t<this.slotNames.length;t++)this.slotNames[t]==e?(this.component.slotManager.mountSlotComponents(e),this.activeSlotName=e):this.component.slotManager.unmountSlotComponents(this.slotNames[t])}};export{x as Component,F as DOMReady,C as SlotToggler,E as Toggler,Z as copyToClipboard,M as escapeHtml,J as fadeIn,Q as fadeOut,Y as formatBytes,te as formatDate,ee as formatDateTime,W as getDefaultLanguage,U as hideElements,R as injectCoreStyles,K as isDarkMode,X as removeSpinnerFromButton,H as scrollToBottom,j as scrollToTop,q as showElements,G as showSpinnerInButton,V as sleep,B as ui_button_status_waiting_off,I as ui_button_status_waiting_off_html,k as ui_button_status_waiting_on,ne as unixtime,z as withMinimumTime};
