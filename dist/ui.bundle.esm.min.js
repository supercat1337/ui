function M(i){document.readyState==="interactive"||document.readyState==="complete"?i():document.addEventListener("DOMContentLoaded",i)}function b(i){return i.replace(/[&<"']/g,e=>({"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"})[e])}function A(i,e){i.disabled=!0,i.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+b(e)}function L(i,e){i.disabled=!1,i.innerText=e}function _(i,e){i.disabled=!1,i.innerHTML=e}function R(i){i.scrollTop=0}function k(i){i.scrollTop=i.scrollHeight}function B(...i){for(let e=0;e<i.length;e++)i[e].classList.add("d-none")}function O(...i){for(let e=0;e<i.length;e++)i[e].classList.remove("d-none")}function D(i,e=null){if(i.getElementsByClassName("spinner-border")[0])return;let t=document.createElement("span");e?t.className=e:t.className="spinner-border spinner-border-sm",i.prepend(t)}function F(i){let e=i.querySelector(".spinner-border");e&&e.remove()}function H(){return Math.floor(new Date().getTime()/1e3)}function U(){return!!(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)}function j(){let i=navigator.language.match(/^[a-z]+/);return i?i[0]:"en"}function I(i,e=2,t,n){t=t||"en",n=n||{en:["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"]};let r=n[t]?n[t]:n.en;if(i===0)return"0 "+r[0];let s=i<0?"-":"";i=Math.abs(i);let o=1024,a=e<0?0:e,f=Math.floor(Math.log(i)/Math.log(o));return s+parseFloat((i/Math.pow(o,f)).toFixed(a))+" "+r[f]}function P(i){return navigator.clipboard.writeText(i)}function q(i){var e=new Date(i*1e3);return`${e.toLocaleDateString("en-GB")} ${e.toLocaleTimeString("en-GB")}`}function G(i){var e=new Date(i*1e3);return`${e.toLocaleDateString("en-GB")}`}var y=class{items=new Map;#e;addItem(e,t,n){if(this.items.has(e))throw new Error("Item already exists");this.items.set(e,{isActive:!1,on:t,off:n})}removeItem(e){this.#e===e&&(this.#e=""),this.items.delete(e)}setActive(e){if(!this.items.has(e))throw new Error("Item not found");if(this.#e!==e)for(let[t,n]of this.items)t===e?(this.#e=t,n.isActive||(n.isActive=!0,n.on(t))):(n.isActive&&n.off(t),n.isActive=!1)}runCallbacks(){for(let[e,t]of this.items)t.isActive?t.on(e):t.off(e)}};var S="scope-ref",v="$",T="ref";function C(i,e){var t;return e.is_scope_element?t=e.is_scope_element(i,e):t=i.getAttribute(S),t===null?!1:t}function $(i){let e={ref_attr_name:T,window:globalThis.window,is_scope_element:void 0,include_root:!1},t=Object.assign({},e,i);if(!t.window)throw new Error("settings.window is not defined");return t}function p(i,e,t={}){var n={},r={},s=[],o=$(t);function a(l){var h=l.getAttribute(o.ref_attr_name);if(h!=null&&h!=""&&(n[h]?globalThis.window?console.warn(`Element has reference #${h} which is already used
`,`
element: `,l,`
reference #${h}: `,n[h],`
scope root: `,i):console.warn(`Element has reference #${h} which is already used
`):n[h]=l),l!=i){var u=C(l,o);if(typeof u!="string")return;u!=""?r[u]?(globalThis.window?console.warn(`scope #${u} is already used`,l):console.warn(`scope #${u} is already used`),s.push(l)):r[u]=l:s.push(l)}e&&e(l)}o.include_root===!0&&i instanceof o.window.HTMLElement&&(n.root=i,e&&e(i)),x(i,a,o);var f=0;return s.forEach(l=>{for(;r[v+f.toString()];)f++;r[v+f.toString()]=l}),{refs:n,scope_refs:r}}function x(i,e,t){var n=$(t);function r(a){var f=a,l=f.parentElement;return l&&l!=i&&C(l,n)!==!1?2:1}let s=n.window.document.createTreeWalker(i,1,r);var o;for(n.include_root===!0&&i instanceof n.window.HTMLElement&&e(i);o=s.nextNode();)e(o)}function m(i,e){for(let t in e){let n=i[t];if(!n)throw new Error(`Missing ref: ${t}`);let r=typeof e[t]=="function"?e[t].prototype:e[t];if(r.isPrototypeOf(n)===!1)throw new Error(`The ref "${t}" must be an instance of ${r.constructor.name} (actual: ${n.constructor.name})`)}}function d(i,e){if(typeof i!="string")throw new Error("html must be a string");let t=e?.window||globalThis.window;if(!t)throw new Error("window is not defined");let r=t.document.createElement("template");return r.innerHTML=i,r.content}var c=class{events={};on(e,t){typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(t);let n=this,r=function(){n.removeListener(e,t)};return!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==1&&this.emit("#has-listeners",e),r}removeListener(e,t){var n;typeof this.events[e]=="object"&&(n=this.events[e].indexOf(t),n>-1&&(this.events[e].splice(n,1),!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==0&&this.emit("#no-listeners",e)))}emit(e){if(typeof this.events[e]=="object"){var t,n,r,s=[].slice.call(arguments,1);for(n=this.events[e].slice(),r=n.length,t=0;t<r;t++)try{n[t].apply(this,s)}catch(o){console.error(e,s),console.error(o)}}}once(e,t){return this.on(e,function n(){this.removeListener(e,n),t.apply(this,arguments)})}waitForEvent(e,t=0){return new Promise(n=>{let r,s=this.on(e,()=>{t>0&&clearTimeout(r),s(),n(!0)});t>0&&(r=setTimeout(()=>{s(),n(!1)},t))})}waitForAnyEvent(e,t=0){return new Promise(n=>{let r,s=[],o=()=>{t>0&&clearTimeout(r),s.forEach(a=>{a()}),n(!0)};e.forEach(a=>{s.push(this.on(a,o))}),t>0&&(r=setTimeout(()=>{o(),n(!1)},t))})}clear(){this.events={}}destroy(){this.clear()}clearEventListeners(e){(this.events[e]||[]).length>0&&(this.events[e]=[],this.emit("#no-listeners",e))}onHasEventListeners(e){return this.on("#has-listeners",e)}onNoEventListeners(e){return this.on("#no-listeners",e)}};var w=class{#e=new Set;#t=new Map;#n=new Set;#r;constructor(e){this.#r=e}defineSlots(...e){let t=[],n=Array.from(this.#e);for(let r=0;r<n.length;r++)e.indexOf(n[r])==-1&&t.push(n[r]);for(let r=0;r<t.length;r++)this.removeSlot(t[r]);for(let r=0;r<e.length;r++)this.#t.has(e[r])||this.#t.set(e[r],new Set);this.#e=new Set(e)}removeSlot(e){let t=this.#t.get(e);if(t){let n=Array.from(t);for(let r=0;r<n.length;r++)this.#r.removeChildComponent(n[r]),n[r].unmount(),this.#n.delete(n[r]);this.#t.delete(e)}this.#e.delete(e)}get slotNames(){return Array.from(this.#e)}slotExists(e){return this.#e.has(e)}addChildComponent(e,...t){if(this.slotExists(e)===!1)throw new Error(`Slot "${e}" does not exist`);let n=this.#t.get(e);n||(n=new Set,this.#t.set(e,n));for(let r=0;r<t.length;r++)this.#n.add(t[r]),n.add(t[r])}removeChildComponent(e){this.#n.delete(e);for(let[t,n]of this.#t)if(n.has(e)){n.delete(e);break}}get children(){return this.#n}mountChildren(e){let t=e?[e]:Array.from(this.#e);for(let n=0;n<t.length;n++){let r=Array.from(this.#t.get(t[n])||[]),s=this.#r.$internals.slotRefs[t[n]];if(s)for(let o=0;o<r.length;o++)r[o].isCollapsed==!1&&r[o].mount(s,"append")}}unmountChildren(e){let t=e?[e]:Array.from(this.#e);for(let n=0;n<t.length;n++){let r=Array.from(this.#t.get(t[n])||[]);for(let s=0;s<r.length;s++)r[s].unmount()}}},g=class{$internals={eventEmitter:new c,disconnectController:new AbortController,root:null,textUpdateFunction:null,textResources:{},refs:{},slotRefs:{},parentComponent:null,parentSlotName:""};#e=null;layout;slots;refsAnnotation;#t=null;#n=!1;slotManager=new w(this);isCollapsed=!1;constructor(){let e=this;this.onConnect(()=>{e.reloadText();try{e.connectedCallback()}catch(t){console.error("Error in connectedCallback:",t)}}),this.onUnmount(()=>{try{e.disconnectedCallback()}catch(t){console.error("Error in disconnectedCallback:",t)}})}reloadText(){this.$internals.textUpdateFunction&&this.$internals.textUpdateFunction(this)}setTextUpdateFunction(e){this.$internals.textUpdateFunction=e}#r(){this.layout&&(this.#e=this.layout,this.layout=null);let e=this.#e||null;if(e==null)return;let t;if(typeof e=="function"){let r=e(this);r instanceof Node?t=r:t=d(r)}else t=d(e);let n=0;for(let r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType===1&&n++;if(n!==1)throw new Error("Layout must have exactly one root element");this.#t=t}setLayout(e,t){this.#e=e,this.#t=null,t&&(this.refsAnnotation=t)}getRefs(){if(!this.#n)throw new Error("Component is not connected to the DOM");return this.$internals.refs}on(e,t){return this.$internals.eventEmitter.on(e,t)}emit(e,...t){return this.$internals.eventEmitter.emit(e,...t)}onBeforeConnect(e){return this.$internals.eventEmitter.on("beforeConnect",e)}onConnect(e){return this.$internals.eventEmitter.on("connect",e)}onMount(e){return this.$internals.eventEmitter.on("mount",e)}onBeforeUnmount(e){return this.$internals.eventEmitter.on("beforeUnmount",e)}onUnmount(e){return this.$internals.eventEmitter.on("unmount",e)}get isConnected(){return this.#n}connect(e){if(this.#n===!0)throw new Error("Component is already connected");this.$internals.root=e;let{refs:t,scope_refs:n}=p(e);this.refsAnnotation&&m(t,this.refsAnnotation),this.$internals.refs=t,this.$internals.slotRefs=n,this.$internals.disconnectController=new AbortController,this.#n=!0,this.$internals.eventEmitter.emit("connect",this)}disconnect(){this.#n!==!1&&(this.#n=!1,this.$internals.disconnectController.abort(),this.$internals.refs={},this.$internals.slotRefs={})}connectedCallback(){}disconnectedCallback(){}mount(e,t="replace"){if(this.#t===null&&this.#r(),this.#t===null)throw new Error("Template is not set");if(this.#n===!0)return;let n=this.#t.cloneNode(!0);this.$internals.eventEmitter.emit("beforeConnect",this,n);let r=n.firstElementChild;t==="replace"?e.replaceChildren(n):t==="append"?e.append(n):t==="prepend"&&e.prepend(n),this.connect(r),this.slotManager.mountChildren(),this.$internals.eventEmitter.emit("mount",this)}unmount(){this.#n!==!1&&(this.$internals.eventEmitter.emit("beforeUnmount",this),this.disconnect(),this.slotManager.unmountChildren(),this.$internals.root?.remove(),this.$internals.eventEmitter.emit("unmount",this))}collapse(){this.unmount(),this.isCollapsed=!0}expand(){this.isCollapsed=!1,this.#n!==!0&&this.$internals.parentComponent!==null&&this.$internals.parentComponent.addChildComponent(this.$internals.parentSlotName,this)}$on(e,t,n){return e.addEventListener(t,n,{signal:this.$internals.disconnectController.signal}),()=>e.removeEventListener(t,n)}getSlotNames(){return this.slotManager.slotNames}defineSlots(...e){this.slotManager.defineSlots(...e)}addChildComponent(e,...t){if(typeof this.slots<"u"&&(this.defineSlots(...this.slots),this.slots=void 0),this.slotManager.slotExists(e)===!1)throw new Error("Slot does not exist");this.slotManager.addChildComponent(e,...t);for(let n=0;n<t.length;n++)t[n].$internals.parentComponent=this,t[n].$internals.parentSlotName=e;this.#n&&this.slotManager.mountChildren(e)}removeChildComponent(e){e.$internals.parentComponent===this&&(e.$internals.parentComponent=null,e.$internals.parentSlotName=null,this.slotManager.removeChildComponent(e))}},E=class{constructor(e,t,n){typeof e.slots<"u"&&(e.defineSlots(...e.slots),e.slots=void 0);for(let r=0;r<t.length;r++)if(e.slotManager.slotExists(t[r])===!1)throw new Error(`Slot ${t[r]} does not exist in component`);if(e.slotManager.slotExists(n)===!1)throw new Error(`Slot ${n} does not exist in component`);this.component=e,this.slotNames=t,this.activeSlotName=n}toggle(e){if(this.slotNames.indexOf(e)===-1)throw new Error(`Slot ${e} is not defined in SlotToggler`);if(e!=this.activeSlotName)for(let t=0;t<this.slotNames.length;t++)this.slotNames[t]==e?(this.component.slotManager.mountChildren(e),this.activeSlotName=e):this.component.slotManager.unmountChildren(this.slotNames[t])}};export{g as Component,M as DOMReady,E as SlotToggler,y as Toggler,P as copyToClipboard,b as escapeHtml,I as formatBytes,G as formatDate,q as formatDateTime,j as getDefaultLanguage,B as hideElements,U as isDarkMode,F as removeSpinnerFromButton,k as scrollToBottom,R as scrollToTop,O as showElements,D as showSpinnerInButton,L as ui_button_status_waiting_off,_ as ui_button_status_waiting_off_html,A as ui_button_status_waiting_on,H as unixtime};
