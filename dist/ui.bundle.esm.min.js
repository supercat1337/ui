function q(r){document.readyState==="complete"?r():document.addEventListener("DOMContentLoaded",r)}var d=class{events={};on(t,e){typeof this.events[t]!="object"&&(this.events[t]=[]),this.events[t].push(e);let n=this,s=function(){n.removeListener(t,e)};return!/^(#has-listeners|#no-listeners)$/.test(t)&&this.events[t].length==1&&this.emit("#has-listeners",t),s}removeListener(t,e){var n;typeof this.events[t]=="object"&&(n=this.events[t].indexOf(e),n>-1&&(this.events[t].splice(n,1),!/^(#has-listeners|#no-listeners)$/.test(t)&&this.events[t].length==0&&this.emit("#no-listeners",t)))}emit(t){if(typeof this.events[t]=="object"){var e,n,s,i=[].slice.call(arguments,1);for(n=this.events[t].slice(),s=n.length,e=0;e<s;e++)try{n[e].apply(this,i)}catch(o){console.error(t,i),console.error(o)}}}once(t,e){return this.on(t,function n(){this.removeListener(t,n),e.apply(this,arguments)})}waitForEvent(t,e=0){return new Promise(n=>{let s,i=this.on(t,()=>{e>0&&clearTimeout(s),i(),n(!0)});e>0&&(s=setTimeout(()=>{i(),n(!1)},e))})}waitForAnyEvent(t,e=0){return new Promise(n=>{let s,i=[],o=()=>{e>0&&clearTimeout(s),i.forEach(a=>{a()}),n(!0)};t.forEach(a=>{i.push(this.on(a,o))}),e>0&&(s=setTimeout(()=>{o(),n(!1)},e))})}clear(){this.events={}}destroy(){this.clear()}clearEventListeners(t){(this.events[t]||[]).length>0&&(this.events[t]=[],this.emit("#no-listeners",t))}onHasEventListeners(t){return this.on("#has-listeners",t)}onNoEventListeners(t){return this.on("#no-listeners",t)}};var U="scope-ref";var B="ref";function W(r,t){var e;return t.is_scope_element?e=t.is_scope_element(r,t):e=r.getAttribute(U),e===null?!1:e}function P(r){let t={ref_attr_name:B,window:globalThis.window,is_scope_element:void 0,include_root:!1},e=Object.assign({},t,r);if(!e.window)throw new Error("settings.window is not defined");return e}function L(r,t,e){var n={},s=P(e);function i(o){let a=o.getAttribute(s.ref_attr_name);a&&(t?t[a]&&(n[a]=o):n[a]=o)}return s.include_root===!0&&r instanceof s.window.HTMLElement&&(n.root=r),A(r,i,s),t&&I(n,t),n}function A(r,t,e){var n=P(e);function s(a){var u=a,_=u.parentElement;return _&&_!=r&&W(_,n)!==!1?2:1}let i=n.window.document.createTreeWalker(r,1,s);var o;for(n.include_root===!0&&r instanceof n.window.HTMLElement&&t(r);o=i.nextNode();)t(o)}function I(r,t){for(let e in t){let n=r[e];if(!n)throw new Error(`Missing ref: ${e}`);let s=typeof t[e]=="function"?t[e].prototype:t[e];if(s.isPrototypeOf(n)===!1)throw new Error(`The ref "${e}" must be an instance of ${s.constructor.name} (actual: ${n.constructor.name})`)}}var l=class{layout;emit(t,...e){this.eventEmitter||(this.eventEmitter=new d),this.eventEmitter.emit(t,...e)}on(t,e){return this.eventEmitter||(this.eventEmitter=new d),this.eventEmitter.on(t,e)}setRoot(t){this.root_element=t}connect(t){if(t&&this.setRoot(t),!this.root_element)throw new Error("Root element is not set");if(this.refs=L(this.root_element,this.refsAnnotation),!this.refs)throw new Error("Failed to connect DOM");this.emit("refsConnected"),this.emit("connect")}setLayout(t){let e=this;this.layout=()=>t(e)}renderLayout(){if(!this.root_element)throw new Error("Root element is not set");this.root_element.innerHTML="";let t=this.layout();typeof t=="string"?this.root_element.innerHTML=t:t instanceof Node&&this.root_element.appendChild(t),this.refs=L(this.root_element,this.refsAnnotation),this.emit("refsConnected"),this.emit("renderLayout"),this.emit("connect")}isConnected(){return!!this.refs}};var p=class extends l{refs;refsAnnotation={section_with_content:HTMLElement.prototype,section_without_content:HTMLElement.prototype,section_error:HTMLElement.prototype,section_loading:HTMLElement.prototype,error_text:HTMLElement.prototype,loading_text:HTMLElement.prototype,no_content_text:HTMLElement.prototype};#t="loading";constructor(){super(),this.on("connect",()=>{this.setStatus(this.#t)})}setStatus(t,e){if(this.#t=t,!!this.isConnected())switch(this.#t){case"content":this.refs.section_with_content.classList.toggle("d-none",!1),this.refs.section_without_content.classList.toggle("d-none",!0),this.refs.section_error.classList.toggle("d-none",!0),this.refs.section_loading.classList.toggle("d-none",!0);break;case"no_content":typeof e=="string"&&(this.refs.no_content_text.innerText=e),this.refs.section_with_content.classList.toggle("d-none",!0),this.refs.section_without_content.classList.toggle("d-none",!1),this.refs.section_error.classList.toggle("d-none",!0),this.refs.section_loading.classList.toggle("d-none",!0);break;case"error":typeof e=="string"&&(this.refs.error_text.innerText=e),this.refs.section_with_content.classList.toggle("d-none",!0),this.refs.section_without_content.classList.toggle("d-none",!0),this.refs.section_error.classList.toggle("d-none",!1),this.refs.section_loading.classList.toggle("d-none",!0);break;case"loading":typeof e=="string"&&(this.refs.loading_text.innerText=e),this.refs.section_with_content.classList.toggle("d-none",!0),this.refs.section_without_content.classList.toggle("d-none",!0),this.refs.section_error.classList.toggle("d-none",!0),this.refs.section_loading.classList.toggle("d-none",!1);break}}};var E={code:-32700,message:"Parse error"};var T=class{code=0;message="";data={};constructor(t){t instanceof Error?(this.message=t.message,this.data=t):typeof t=="string"?this.message=t:(this.code=t.code||0,this.message=t.message||"",this.data=t.data||{})}},c=class{error;id;constructor(t,e){this.error=new T(t),this.id=e||null}},x=class{result;id;constructor(t,e){this.result=t,this.id=e||null}},R=class{data=[];total=0;page_size=0;current_page=0;total_pages=0;constructor(t){if(!Array.isArray(t.data))throw console.error(t),new Error("data must be an array");let e=typeof t.total=="number"?t.total:parseInt(t.total),n=typeof t.page_size=="number"?t.page_size:parseInt(t.page_size),s=typeof t.current_page=="number"?t.current_page:parseInt(t.current_page),i=typeof t.total_pages=="number"?t.total_pages:parseInt(t.total_pages);if(isNaN(e))throw console.error(t),new Error("total must be a number");if(isNaN(n))throw console.error(t),new Error("page_size must be a number");if(isNaN(s))throw console.error(t),new Error("current_page must be a number");if(isNaN(i))throw console.error(t),new Error("total_pages must be a number");this.data=t.data,this.total=t.total,this.page_size=t.page_size,this.current_page=t.current_page,this.total_pages=t.total_pages}},h=class{result;id;constructor(t,e){this.result=new R(t),this.id=e||null}},v=class{#t=new d;on(t,e){this.#t.on(t,e)}notify(t){t&&t.id&&typeof t.id=="string"&&(t.hasOwnProperty("error")||t.hasOwnProperty("result"))&&setTimeout(()=>this.#t.emit(t.id,t),0)}},G=new v;function w(r){return r&&(r.hasOwnProperty("error")||r.hasOwnProperty("result"))}function D(r,t=null){if(!w(r))return console.error(r),new c(E,t);if(r.error)return new c(r.error,r.id||t);if(r.result)return!1}function J(r,t=null){if(!w(r))return console.error(r),new c(E,t);let e=D(r);if(e)return e;try{return new h(r.result,r.id)}catch(n){return console.error(n),new c(n,r.id||t)}}function Q(r){if(!w(r))return console.error(r),!1;if(r.error)return!1;if(r.result)return r.result.hasOwnProperty("total_pages")&&r.result.hasOwnProperty("current_page")&&r.result.hasOwnProperty("page_size")&&r.result.hasOwnProperty("total")&&r.result.hasOwnProperty("data")}function X(r,t){if(!w(r))return console.error(r),new c(E,t);let e=D(r);return e||new x(r.result,r.id||t)}function K(r){return r.error?"error":r.result?Q(r)?"pagedData":"data":"error"}function m(r={},t={}){if(t.notify=t.hasOwnProperty("notify")?t.notify:!0,!w(r))return new c(E,t.id);let e=K(r),n;return e==="error"?n=new c(r.error,r.id||t.id):e==="data"?n=X(r,r.id||t.id):e==="pagedData"&&(n=J(r,r.id||t.id)),t.notify&&G.notify(n),n}var H=class r{static createPaginationArray(t,e,n=2,s="..."){if(e<=1)return["1"];let i=[t];for(let f=1;f<=n;f++)i.unshift(t-f),i.push(t+f);let o=i.filter(f=>f>1&&f<e).map(f=>f.toString()),a=t>3+n,u=t===3+n,_=t<e-(2+n),V=t===e-(2+n);u&&o.unshift("2"),V&&o.push((e-1).toString()),a&&o.unshift(s),_&&o.push(s);let z=e.toString();return["1",...o,z]}static renderPaginationItems(t,e,n){let s=t.toString(),i=r.createPaginationArray(t,e);return i=i.map(function(o){let a=s==o?"active":"",u=n?n(o):"#";return o!="..."?`<li class="page-item ${a}" page-value="${o}"><a class="page-link" href="${u}">${o}</a></li>`:`<li class="page-item"><span class="page-link">${o}</span></li>`}),i.join(`
`)}static renderPagination(t,e,n){return`
  <ul class="pagination">
  ${r.renderPaginationItems(t,e,n)}
  </ul>`}};function M(r){return H.renderPagination(r.current_page,r.pages_count,r.page_url_rendrer)}var g=class extends l{root_element;eventsDeclaration=["page-changed"];page_url_rendrer;#t=0;pages_count=0;constructor(){super(),this.setLayout(M)}on(t,e){return super.on(t,e)}setConfig(t){this.page_url_rendrer=t.page_url_rendrer}set current_page(t){this.#t=t,this.root_element&&this.render()}get current_page(){return this.#t}#e(t,e){if(!this.root_element)throw new Error("Pagination root_element element is not set");typeof e<"u"&&(this.pages_count=e),typeof t<"u"&&(this.#t=t),this.root_element.innerHTML=M(this);let n=this.root_element.querySelectorAll(".page-item"),s=this;for(let i=0;i<n.length;i++)n[i].addEventListener("click",o=>{if(o.preventDefault(),!(o.target instanceof Element))return;let a=o.target;if(a.tagName!="LI"&&(a=a.parentElement,!(a instanceof Element)))return;let u=a.getAttribute("page-value");u&&(s.#t=parseInt(u),s.#e(),super.emit("page-changed",s.#t))})}render(t){let e=m(t);if(e&&e instanceof h){this.#e(e.result.current_page,e.result.total_pages);return}else this.#e(this.#t,this.pages_count)}};function O(){return`
<table class="table table-striped">
    <thead>
        <tr ref="header_row">

        </tr>
    </thead>
    <tbody ref="section_with_content" class="d-none">
    </tbody>
    <tbody ref="section_without_content" class="d-none">
        <tr>
            <td ref="no_content_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">
                No items
            </td>
        </tr>
    </tbody>
    <tbody ref="section_error" class="d-none">
        <tr>
            <td ref="error_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">

            </td>
        </tr>
    </tbody>
    <tbody ref="section_loading" class="">
        <tr>
            <td ref="loading_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">
                Loading...
            </td>
        </tr>
    </tbody>

</table>
`}function $(r,t){let e=document.createElement("div");e.setAttribute("data-row-index",t.toString());let n=document.createElement("span");n.setAttribute("ref","index"),n.innerText=(t+1).toString(),e.appendChild(n);for(let s in r){let i=document.createElement("span");i.setAttribute("ref",s),i.innerText=r[s],e.appendChild(i)}return e}var y=class extends l{root_element=null;eventsDeclaration=["connect"];refs;refsAnnotation={section_with_content:HTMLDivElement.prototype,section_without_content:HTMLDivElement.prototype,section_error:HTMLDivElement.prototype,section_loading:HTMLDivElement.prototype,header_row:HTMLDivElement.prototype,error_text:HTMLElement.prototype,loading_text:HTMLElement.prototype,no_content_text:HTMLElement.prototype};list_row_header_string="";#t=$;#e="loading";constructor(){super(),this.widget=new p;let t=this;this.on("connect",()=>{t.root_element&&t.widget.connect(t.root_element),t.widget.setStatus(t.status),t.refs.header_row.innerHTML=t.list_row_header_string}),this.setLayout(O)}on(t,e){return super.on(t,e)}setConfig(t){let e=Object.assign({listItemRenderer:$,list_row_header_string:null},t);e.listItemRenderer&&(this.#t=e.listItemRenderer),e.list_row_header_string&&(this.list_row_header_string=e.list_row_header_string)}get status(){return this.#e}setListItemHeaderString(t){this.list_row_header_string=t}setStatus(t,e){this.#e=t,this.widget.setStatus(t,e)}render(t){if(!this.refs)return;let e=m(t);if(this.refs.section_with_content.innerHTML="",e instanceof c){this.setStatus("error",e.error.message);return}if(!(e instanceof h)){this.setStatus("error","Invalid response");return}let n=e.result.data;if(n.length==0){this.setStatus("no_content");return}this.#r(n),this.setStatus("content")}#r(t){if(this.refs){this.refs.section_with_content.innerHTML="";for(let e=0;e<t.length;e++){let n=this.#t(t[e],e);this.refs.section_with_content.appendChild(n)}}}};function k(){return`
<table class="table table-striped">
    <thead>
        <tr ref="header_row">

        </tr>
    </thead>
    <tbody ref="section_with_content" class="d-none">
    </tbody>
    <tbody ref="section_without_content" class="d-none">
        <tr>
            <td ref="no_content_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">
                No items
            </td>
        </tr>
    </tbody>
    <tbody ref="section_error" class="d-none">
        <tr>
            <td ref="error_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">

            </td>
        </tr>
    </tbody>
    <tbody ref="section_loading" class="">
        <tr>
            <td ref="loading_text" class="col-12 text-center py-4" colspan="100"
                style="white-space: initial; word-wrap: break-word;">
                Loading...
            </td>
        </tr>
    </tbody>

</table>
`}function j(r,t){let e=document.createElement("tr");e.setAttribute("data-row-index",t.toString());let n=document.createElement("td");n.setAttribute("ref","index"),n.innerText=(t+1).toString(),e.appendChild(n);for(let s in r){let i=document.createElement("td");i.setAttribute("ref",s),i.innerText=r[s],e.appendChild(i)}return e}var b=class extends l{root_element=null;eventsDeclaration=["connect","refsConnected"];refs;refsAnnotation={section_with_content:HTMLTableSectionElement.prototype,section_without_content:HTMLTableSectionElement.prototype,section_error:HTMLTableSectionElement.prototype,section_loading:HTMLTableSectionElement.prototype,header_row:HTMLTableRowElement.prototype,error_text:HTMLElement.prototype,loading_text:HTMLElement.prototype,no_content_text:HTMLElement.prototype};#t="";#e=j;#r="loading";constructor(){super(),this.widget=new p;let t=this;this.on("refsConnected",()=>{t.widget.connect(t.root_element),t.widget.setStatus(t.status),t.refs.header_row.innerHTML=t.#t}),this.setLayout(k)}on(t,e){return super.on(t,e)}setConfig(t){let e=Object.assign({tableRowRenderer:j,table_row_header_string:null},t);e.tableRowRenderer&&(this.#e=e.tableRowRenderer),e.table_row_header_string&&(this.#t=e.table_row_header_string)}get status(){return this.#r}setStatus(t,e){this.#r=t,this.widget.setStatus(t,e)}render(t){if(!this.refs)return;let e=m(t);if(this.refs.section_with_content.innerHTML="",e instanceof c){this.setStatus("error",e.error.message);return}if(!(e instanceof h)){this.setStatus("error","Invalid response");return}let n=e.result.data;if(n.length==0){this.setStatus("no_content");return}this.#n(n),this.setStatus("content")}#n(t){if(this.refs){this.refs.section_with_content.innerHTML="";for(let e=0;e<t.length;e++){let n=this.#e(t[e],e);this.refs.section_with_content.appendChild(n)}}}};function N(){return`
<div class="d-flex flex-column" style="min-height: 80vh">
    <div class="flex-grow-1 mt-3">
        <h1 class="display-6">
            <span ref="title">List</span>
            <button class="btn btn-outline-secondary btn-sm ms-2" ref="add_data_button">
                Add
            </button>

            <button class="btn btn-outline-secondary btn-sm ms-2" ref="update_data_button">
                Update
            </button>
        </h1>
    
        <div ref="listItems" scope-ref="listItems">
        </div>

    </div>
</div>
<div aria-label="Page navigation" class="mt-5 d-flex justify-content-center" ref="pagination_section" scope-ref="pagination">
</div>
`}var S=class extends l{itemList;pagination;root_element;refsAnnotation={title:HTMLSpanElement.prototype,add_data_button:HTMLButtonElement.prototype,update_data_button:HTMLButtonElement.prototype,itemList:HTMLElement.prototype,pagination_section:HTMLElement.prototype};refs;eventsDeclaration=["connect","refsConnected","renderLayout"];#t="";constructor(){super(),this.itemList=new y,this.pagination=new g,this.setLayout(N),this.on("refsConnected",()=>{this.refs.title.innerText=this.#t,this.itemList.setRoot(this.refs.itemList),this.pagination.setRoot(this.refs.pagination_section)}),this.on("renderLayout",()=>{this.itemList.renderLayout(),this.pagination.renderLayout()})}on(t,e){return super.on(t,e)}get status(){return this.itemList.status}setStatus(t,e){this.isConnected()&&this.itemList.setStatus(t,e)}set title(t){this.#t=t,this.isConnected()&&(this.refs.title.innerText=this.#t)}get title(){return this.#t}render(t){this.itemList.render(t),this.pagination.render(t)}};function F(){return`
<div class="d-flex flex-column" style="min-height: 80vh">
    <div class="flex-grow-1 mt-3">
        <h1 class="display-6">
            <span ref="title">Table</span>
            <button class="btn btn-outline-secondary btn-sm ms-2" ref="add_data_button">
                Add
            </button>

            <button class="btn btn-outline-secondary btn-sm ms-2" ref="update_data_button">
                Update
            </button>
        </h1>
    
        <table class="table table-striped" ref="table" scope-ref="table">
        </table>

    </div>
</div>
<div aria-label="Page navigation" class="mt-5 d-flex justify-content-center" ref="pagination_section" scope-ref="pagination">
</div>
`}var C=class extends l{tableView;pagination;root_element;refsAnnotation={title:HTMLSpanElement.prototype,add_data_button:HTMLButtonElement.prototype,update_data_button:HTMLButtonElement.prototype,table:HTMLTableElement.prototype,pagination_section:HTMLElement.prototype};refs;eventsDeclaration=["connect","refsConnected","renderLayout"];#t="";constructor(){super(),this.tableView=new b,this.pagination=new g,this.setLayout(F),this.on("refsConnected",()=>{this.refs.title.innerText=this.#t,this.tableView.setRoot(this.refs.table),this.pagination.setRoot(this.refs.pagination_section)}),this.on("renderLayout",()=>{this.tableView.renderLayout(),this.pagination.renderLayout()})}on(t,e){return super.on(t,e)}get status(){return this.tableView.status}setStatus(t,e){this.isConnected()&&this.tableView.setStatus(t,e)}set title(t){this.#t=t,this.isConnected()&&(this.refs.title.innerText=this.#t)}get title(){return this.#t}render(t){this.tableView.render(t),this.pagination.render(t)}};export{l as Component,q as DOMReady,y as ItemList,S as PaginatedItemList,C as PaginatedTable,g as Pagination,b as TableView,p as Widget};
