function M(r){document.readyState==="interactive"||document.readyState==="complete"?r():document.addEventListener("DOMContentLoaded",r)}function x(r){return r.replace(/[&<"']/g,e=>({"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"})[e])}function A(r,e){r.disabled=!0,r.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+x(e)}function _(r,e){r.disabled=!1,r.innerText=e}function L(r,e){r.disabled=!1,r.innerHTML=e}function R(r){r.scrollTop=0}function O(r){r.scrollTop=r.scrollHeight}function k(...r){for(let e=0;e<r.length;e++)r[e].classList.add("d-none")}function B(...r){for(let e=0;e<r.length;e++)r[e].classList.remove("d-none")}function D(r,e=null){if(r.getElementsByClassName("spinner-border")[0])return;let t=document.createElement("span");e?t.className=e:t.className="spinner-border spinner-border-sm",r.prepend(t)}function F(r){let e=r.querySelector(".spinner-border");e&&e.remove()}function U(){return Math.floor(new Date().getTime()/1e3)}function H(){return!!(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)}function P(){let r=navigator.language.match(/^[a-z]+/);return r?r[0]:"en"}function j(r,e=2,t,n){t=t||"en",n=n||{en:["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"]};let i=n[t]?n[t]:n.en;if(r===0)return"0 "+i[0];let s=r<0?"-":"";r=Math.abs(r);let o=1024,a=e<0?0:e,f=Math.floor(Math.log(r)/Math.log(o));return s+parseFloat((r/Math.pow(o,f)).toFixed(a))+" "+i[f]}function I(r){return navigator.clipboard.writeText(r)}function q(r){var e=new Date(r*1e3);return`${e.toLocaleDateString("en-GB")} ${e.toLocaleTimeString("en-GB")}`}function G(r){var e=new Date(r*1e3);return`${e.toLocaleDateString("en-GB")}`}var y=class{items=new Map;#e;addItem(e,t,n){if(this.items.has(e))throw new Error("Item already exists");this.items.set(e,{isActive:!1,on:t,off:n})}removeItem(e){this.#e===e&&(this.#e=""),this.items.delete(e)}setActive(e){if(!this.items.has(e))throw new Error("Item not found");if(this.#e!==e)for(let[t,n]of this.items)t===e?(this.#e=t,n.isActive||(n.isActive=!0,n.on(t))):(n.isActive&&n.off(t),n.isActive=!1)}runCallbacks(){for(let[e,t]of this.items)t.isActive?t.on(e):t.off(e)}};var S="scope-ref";function C(r,e){var t;return e.is_scope_element?t=e.is_scope_element(r,e):t=r.getAttribute(S),t===null?!1:t}function v(r){let e={ref_attr_name:"ref",window:globalThis.window,is_scope_element:void 0,include_root:!1},t=Object.assign({},e,r);if(!t.window)throw new Error("settings.window is not defined");return t}function m(r,e,t={}){var n={},i={},s=[],o=v(t);function a(l){var h=l.getAttribute(o.ref_attr_name);if(h!=null&&h!=""&&(n[h]?globalThis.window?console.warn(`Element has reference #${h} which is already used
`,`
element: `,l,`
reference #${h}: `,n[h],`
scope root: `,r):console.warn(`Element has reference #${h} which is already used
`):n[h]=l),l!=r){var u=C(l,o);if(typeof u!="string")return;u!=""?i[u]?(globalThis.window?console.warn(`scope #${u} is already used`,l):console.warn(`scope #${u} is already used`),s.push(l)):i[u]=l:s.push(l)}e&&e(l)}o.include_root===!0&&r instanceof o.window.HTMLElement&&(n.root=r,e&&e(r)),$(r,a,o);var f=0;return s.forEach(l=>{for(;i["$"+f.toString()];)f++;i["$"+f.toString()]=l}),{refs:n,scope_refs:i}}function $(r,e,t){var n=v(t);function i(a){var f=a,l=f.parentElement;return l&&l!=r&&C(l,n)!==!1?2:1}let s=n.window.document.createTreeWalker(r,1,i);var o;for(n.include_root===!0&&r instanceof n.window.HTMLElement&&e(r);o=s.nextNode();)e(o)}function w(r,e){for(let t in e){let n=r[t];if(!n)throw new Error(`Missing ref: ${t}`);let i=typeof e[t]=="function"?e[t].prototype:e[t];if(i.isPrototypeOf(n)===!1)throw new Error(`The ref "${t}" must be an instance of ${i.constructor.name} (actual: ${n.constructor.name})`)}}function d(r,e){if(typeof r!="string")throw new Error("html must be a string");let t=e?.window||globalThis.window;if(!t)throw new Error("window is not defined");let i=t.document.createElement("template");return i.innerHTML=r,i.content}var c=class{events={};on(e,t){typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(t);let n=this,i=function(){n.removeListener(e,t)};return!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==1&&this.emit("#has-listeners",e),i}removeListener(e,t){var n;typeof this.events[e]=="object"&&(n=this.events[e].indexOf(t),n>-1&&(this.events[e].splice(n,1),!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==0&&this.emit("#no-listeners",e)))}emit(e){if(typeof this.events[e]=="object"){var t,n,i,s=[].slice.call(arguments,1);for(n=this.events[e].slice(),i=n.length,t=0;t<i;t++)try{n[t].apply(this,s)}catch(o){console.error(e,s),console.error(o)}}}once(e,t){return this.on(e,function n(){this.removeListener(e,n),t.apply(this,arguments)})}waitForEvent(e,t=0){return new Promise(n=>{let i,s=this.on(e,()=>{t>0&&clearTimeout(i),s(),n(!0)});t>0&&(i=setTimeout(()=>{s(),n(!1)},t))})}waitForAnyEvent(e,t=0){return new Promise(n=>{let i,s=[],o=()=>{t>0&&clearTimeout(i),s.forEach(a=>{a()}),n(!0)};e.forEach(a=>{s.push(this.on(a,o))}),t>0&&(i=setTimeout(()=>{o(),n(!1)},t))})}clear(){this.events={}}destroy(){this.clear()}clearEventListeners(e){(this.events[e]||[]).length>0&&(this.events[e]=[],this.emit("#no-listeners",e))}onHasEventListeners(e){return this.on("#has-listeners",e)}onNoEventListeners(e){return this.on("#no-listeners",e)}};var p=class{#e=new Set;#t=new Map;#n=new Set;#r;constructor(e){this.#r=e}defineSlots(...e){let t=[],n=Array.from(this.#e);for(let i=0;i<n.length;i++)e.indexOf(n[i])==-1&&t.push(n[i]);for(let i=0;i<t.length;i++)this.removeSlot(t[i]);for(let i=0;i<e.length;i++)this.#t.has(e[i])||this.#t.set(e[i],new Set);this.#e=new Set(e)}removeSlot(e){let t=this.#t.get(e);if(t){let n=Array.from(t);for(let i=0;i<n.length;i++)this.#r.removeChildComponent(n[i]),n[i].unmount(),this.#n.delete(n[i]);this.#t.delete(e)}this.#e.delete(e)}get slotNames(){return Array.from(this.#e)}slotExists(e){return this.#e.has(e)}addChildComponent(e,...t){if(this.slotExists(e)===!1)throw new Error(`Slot "${e}" does not exist`);let n=this.#t.get(e);n||(n=new Set,this.#t.set(e,n));for(let i=0;i<t.length;i++)this.#n.add(t[i]),n.add(t[i])}removeChildComponent(e){this.#n.delete(e);for(let[t,n]of this.#t)if(n.has(e)){n.delete(e);break}}get children(){return this.#n}mountChildren(e){let t=e?[e]:Array.from(this.#e);for(let n=0;n<t.length;n++){let i=Array.from(this.#t.get(t[n])||[]),s=this.#r.$internals.slotRefs[t[n]];if(s)for(let o=0;o<i.length;o++)i[o].isCollapsed==!1&&i[o].mount(s,"append")}}unmountChildren(e){let t=e?[e]:Array.from(this.#e);for(let n=0;n<t.length;n++){let i=Array.from(this.#t.get(t[n])||[]);for(let s=0;s<i.length;s++)i[s].unmount()}}};function b(r){r.reloadText();try{r.connectedCallback()}catch(e){console.error("Error in connectedCallback:",e)}}function T(r){try{r.disconnectedCallback()}catch(e){console.error("Error in disconnectedCallback:",e)}}var g=class{$internals={eventEmitter:new c,disconnectController:new AbortController,root:null,textUpdateFunction:null,textResources:{},refs:{},slotRefs:{},parentComponent:null,parentSlotName:""};#e=null;layout;slots;refsAnnotation;#t=null;#n=!1;slotManager=new p(this);isCollapsed=!1;constructor(){this.onConnect(b),this.onUnmount(T)}reloadText(){this.$internals.textUpdateFunction&&this.$internals.textUpdateFunction(this)}setTextUpdateFunction(e){this.$internals.textUpdateFunction=e}#r(){this.layout&&(this.#e=this.layout,this.layout=null);let e=this.#e||null;if(e==null)return;let t;if(typeof e=="function"){let i=e(this);i instanceof Node?t=i:t=d(i)}else t=d(e);let n=0;for(let i=0;i<t.childNodes.length;i++)t.childNodes[i].nodeType===1&&n++;if(n!==1)throw new Error("Layout must have exactly one root element");this.#t=t}setLayout(e,t){this.#e=e,this.#t=null,t&&(this.refsAnnotation=t)}getRefs(){if(!this.#n)throw new Error("Component is not connected to the DOM");return this.$internals.refs}on(e,t){return this.$internals.eventEmitter.on(e,t)}emit(e,...t){return this.$internals.eventEmitter.emit(e,this,...t)}onBeforeConnect(e){return this.$internals.eventEmitter.on("beforeConnect",e)}onConnect(e){return this.$internals.eventEmitter.on("connect",e)}onMount(e){return this.$internals.eventEmitter.on("mount",e)}onBeforeUnmount(e){return this.$internals.eventEmitter.on("beforeUnmount",e)}onUnmount(e){return this.$internals.eventEmitter.on("unmount",e)}get isConnected(){return this.#n}connect(e){if(this.#n===!0)throw new Error("Component is already connected");this.$internals.root=e;let{refs:t,scope_refs:n}=m(e);this.refsAnnotation&&w(t,this.refsAnnotation),this.$internals.refs=t,this.$internals.slotRefs=n,this.$internals.disconnectController=new AbortController,this.#n=!0,this.slotManager.mountChildren(),this.emit("connect")}disconnect(){this.#n!==!1&&(this.#n=!1,this.$internals.disconnectController.abort(),this.$internals.refs={},this.$internals.slotRefs={})}connectedCallback(){}disconnectedCallback(){}mount(e,t="replace"){if(this.#t===null&&this.#r(),this.#t===null)throw new Error("Template is not set");if(this.#n===!0)return;let n=this.#t.cloneNode(!0);this.emit("beforeConnect",n);let i=n.firstElementChild;t==="replace"?e.replaceChildren(n):t==="append"?e.append(n):t==="prepend"&&e.prepend(n),this.connect(i),this.emit("mount")}unmount(){this.#n!==!1&&(this.emit("beforeUnmount"),this.disconnect(),this.slotManager.unmountChildren(),this.$internals.root?.remove(),this.emit("unmount"))}collapse(){this.unmount(),this.isCollapsed=!0}expand(){this.isCollapsed=!1,this.#n!==!0&&this.$internals.parentComponent!==null&&this.$internals.parentComponent.addChildComponent(this.$internals.parentSlotName,this)}show(){if(!this.isConnected)return;let e=this.$internals.root;e&&e.classList.remove("d-none")}hide(){if(!this.isConnected)return;let e=this.$internals.root;e&&e.classList.add("d-none")}$on(e,t,n){return e.addEventListener(t,n,{signal:this.$internals.disconnectController.signal}),()=>e.removeEventListener(t,n)}getSlotNames(){return this.slotManager.slotNames}defineSlots(...e){this.slotManager.defineSlots(...e)}addChildComponent(e,...t){if(typeof this.slots<"u"&&(this.defineSlots(...this.slots),this.slots=void 0),this.slotManager.slotExists(e)===!1)throw new Error("Slot does not exist");this.slotManager.addChildComponent(e,...t);for(let n=0;n<t.length;n++)t[n].$internals.parentComponent=this,t[n].$internals.parentSlotName=e;this.#n&&this.slotManager.mountChildren(e)}removeChildComponent(e){e.$internals.parentComponent===this&&(e.$internals.parentComponent=null,e.$internals.parentSlotName="",this.slotManager.removeChildComponent(e))}};var E=class{constructor(e,t,n){typeof e.slots<"u"&&(e.defineSlots(...e.slots),e.slots=void 0);for(let i=0;i<t.length;i++)if(e.slotManager.slotExists(t[i])===!1)throw new Error(`Slot ${t[i]} does not exist in component`);if(e.slotManager.slotExists(n)===!1)throw new Error(`Slot ${n} does not exist in component`);this.component=e,this.slotNames=t,this.activeSlotName=n}toggle(e){if(this.slotNames.indexOf(e)===-1)throw new Error(`Slot ${e} is not defined in SlotToggler`);if(e!=this.activeSlotName)for(let t=0;t<this.slotNames.length;t++)this.slotNames[t]==e?(this.component.slotManager.mountChildren(e),this.activeSlotName=e):this.component.slotManager.unmountChildren(this.slotNames[t])}};export{g as Component,M as DOMReady,E as SlotToggler,y as Toggler,I as copyToClipboard,x as escapeHtml,j as formatBytes,G as formatDate,q as formatDateTime,P as getDefaultLanguage,k as hideElements,H as isDarkMode,F as removeSpinnerFromButton,O as scrollToBottom,R as scrollToTop,B as showElements,D as showSpinnerInButton,_ as ui_button_status_waiting_off,L as ui_button_status_waiting_off_html,A as ui_button_status_waiting_on,U as unixtime};
