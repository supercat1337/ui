function P(n,e=window.document){e.readyState==="interactive"||e.readyState==="complete"?n():e.addEventListener("DOMContentLoaded",n)}function M(n){return n.replace(/[&<"']/g,function(e){return{"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})}function F(n,e){n.disabled=!0,n.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+M(e)}function k(n,e){n.disabled=!1,n.innerText=e}function I(n,e){n.disabled=!1,n.innerHTML=e}function B(n){n.scrollTop=0}function j(n){n.scrollTop=n.scrollHeight}function H(...n){for(let e=0;e<n.length;e++)n[e].classList.add("d-none")}function U(...n){for(let e=0;e<n.length;e++)n[e].classList.remove("d-none")}function q(n,e=null,t=window.document){if(n.getElementsByClassName("spinner-border")[0])return;let r=t.createElement("span");e?r.className=e:r.className="spinner-border spinner-border-sm",n.prepend(r)}function G(n){let e=n.querySelector(".spinner-border");e&&e.remove()}function W(n=window){return!!(n.matchMedia&&n.matchMedia("(prefers-color-scheme: dark)").matches)}function X(){let n=navigator.language.match(/^[a-z]+/);return n?n[0]:"en"}function K(n,e=2,t,r){t=t||"en",r=r||{en:["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"]};let i=r[t]?r[t]:r.en;if(n===0)return"0 "+i[0];let s=n<0?"-":"";n=Math.abs(n);let o=1024,l=e<0?0:e,f=Math.floor(Math.log(n)/Math.log(o));return s+parseFloat((n/Math.pow(o,f)).toFixed(l))+" "+i[f]}function Y(n){return navigator.clipboard.writeText(n)}function Z(n,e=400,t=window){n.style.opacity="0",n.style.display="block";let r=+new Date,i=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity+(s-r)/e),r=+new Date,+n.style.opacity<1&&(t.requestAnimationFrame&&t.requestAnimationFrame(i)||setTimeout(i,16))};i()}function J(n,e=400,t=window){n.style.opacity="1";let r=+new Date,i=()=>{let s=+new Date;n.style.opacity=String(+n.style.opacity-(s-r)/e),r=+new Date,+n.style.opacity>0&&(t.requestAnimationFrame&&t.requestAnimationFrame(i)||setTimeout(i,16))};i()}function Q(n){return new Promise(e=>setTimeout(e,n))}function V(n,e){return new Promise((t,r)=>{let i=Date.now(),s=!1,o=!1,l,f,c=setTimeout(()=>{o=!0,s&&(f?r(f):t(l))},e);n.then(a=>{l=a,s=!0,Date.now()-i>=e&&o&&t(a)}).catch(a=>{f=a,s=!0,Date.now()-i>=e&&o&&r(a)})})}async function z(n,e){}function ee(n){var e=new Date(n*1e3);return`${e.toLocaleDateString("en-GB")} ${e.toLocaleTimeString("en-GB")}`}function te(n){var e=new Date(n*1e3);return`${e.toLocaleDateString("en-GB")}`}function ne(n=new Date){return Math.floor(n.getTime()/1e3)}var y=class{items=new Map;#t="";addItem(e,t,r){if(this.items.has(e))throw new Error("Item already exists");this.items.set(e,{isActive:!1,on:t,off:r})}removeItem(e){this.#t===e&&(this.#t=""),this.items.delete(e)}setActive(e){if(!this.items.has(e))throw new Error("Item not found");if(this.#t!==e)for(let[t,r]of this.items)t===e?(this.#t=t,r.isActive||(r.isActive=!0,r.on(t))):(r.isActive&&r.off(t),r.isActive=!1)}runCallbacks(){for(let[e,t]of this.items)t.isActive?t.on(e):t.off(e)}init(e){this.setActive(e),this.runCallbacks()}};function E(n=window.document){if(!n)throw new Error("Document is null. Cannot inject core styles.");let e=`
.d-none {
    display: none !important;
}

html-fragment {
    display: contents;
}
`,t=new CSSStyleSheet;t.replaceSync(e),n.adoptedStyleSheets=[...n.adoptedStyleSheets,t]}var v="data-scope",R="unnamed-scope",A="data-ref",m=class{ref_attr_name;scope_ref_attr_name;window;isScopeElement;includeRoot;scope_auto_name_prefix;constructor(){this.ref_attr_name=A,this.scope_ref_attr_name=v,this.window=globalThis.window,this.isScopeElement=null,this.includeRoot=!1,this.scope_auto_name_prefix=R}toString(){return`ScopeConfig(ref_attr_name=${this.ref_attr_name}, scope_ref_attr_name=${this.scope_ref_attr_name}, includeRoot=${this.includeRoot}, scope_auto_name_prefix=${this.scope_auto_name_prefix}, window=${this.window?"defined":"undefined"}, isScopeElement=${this.isScopeElement})`}},u=new m;function $(n,e){var t=null;e||(e=u);let r=e.scope_ref_attr_name||v,i=e.isScopeElement;return i?t=i(n,e):t=n.getAttribute(r),t===null?null:t}function g(n={}){let e=new m;return e.includeRoot=n.hasOwnProperty("includeRoot")&&typeof n.includeRoot<"u"?n.includeRoot:u.includeRoot,e.scope_auto_name_prefix=n.hasOwnProperty("scope_auto_name_prefix")&&typeof n.scope_auto_name_prefix=="string"?n.scope_auto_name_prefix:u.scope_auto_name_prefix,e.isScopeElement=n.hasOwnProperty("isScopeElement")&&typeof n.isScopeElement<"u"?n.isScopeElement:u.isScopeElement,e.ref_attr_name=n.hasOwnProperty("ref_attr_name")&&typeof n.ref_attr_name=="string"?n.ref_attr_name:u.ref_attr_name,e.window=n.hasOwnProperty("window")&&typeof n.window<"u"?n.window:u.window,e.scope_ref_attr_name=n.hasOwnProperty("scope_ref_attr_name")&&typeof n.scope_ref_attr_name=="string"?n.scope_ref_attr_name:u.scope_ref_attr_name,e}function b(n,e,t={}){var r={},i={},s=[];let o=g(t);function l(a){var h=a.getAttribute(o.ref_attr_name);if(h!=null&&h!=""&&(r[h]?globalThis.window?console.warn(`Element has reference #${h} which is already used
`,`
element: `,a,`
reference #${h}: `,r[h],`
scope root: `,n):console.warn(`Element has reference #${h} which is already used
`):r[h]=a),a!=n){var d=$(a,o);if(typeof d!="string")return;d!=""?i[d]?(console.warn(`scope #${d} is already used`,globalThis.window?a:""),s.push(a)):i[d]=a:s.push(a)}e&&e(a)}o.includeRoot===!0&&n instanceof o.window.HTMLElement&&(r.root=n,e&&e(n)),O(n,l,o);var f=0;let c=o.scope_auto_name_prefix;return s.forEach(a=>{for(;i[c+f.toString()];)f++;i[c+f.toString()]=a}),{refs:r,scope_refs:i}}function O(n,e,t){let r=g(t);function i(l){var f=l,c=f.parentElement;return c&&c!=n&&$(c,r)!==null?2:1}let s=r.window.document.createTreeWalker(n,1,i);var o;for(r.includeRoot===!0&&n instanceof r.window.HTMLElement&&e(n);o=s.nextNode();)e(o)}function T(n,e){for(let t in e){let r=n[t];if(!r)throw new Error(`Missing data-ref: ${t}`);let i=typeof e[t]=="function"?e[t].prototype:e[t];if(i.isPrototypeOf(r)===!1)throw new Error(`The data-ref "${t}" must be an instance of ${i.constructor.name} (actual: ${r.constructor.name})`)}}function S(n,e){if(typeof n!="string")throw new Error("html must be a string");let t=g(e);if(!t.window)throw new Error("window is not defined in options");let s=t.window.document.createElement("template");return s.innerHTML=n,s.content}var w=class{#t=new Set;#e=new Map;#n=new Set;#r;#i=!1;constructor(e){this.#r=e}setSlotStrictMode(e){this.#i=e}defineSlots(...e){let t=new Set(e);for(let r of this.#t)t.has(r)||this.removeSlot(r);for(let r of t)this.addSlot(r)}addSlot(e){this.#e.has(e)||this.#e.set(e,new Set),this.#t.add(e)}removeSlot(e){if(!this.#t.has(e))return;let t=this.#e.get(e);t&&(t.forEach(r=>{this.#r.removeChildComponent(r),r.unmount(),this.#n.delete(r)}),this.#e.delete(e)),this.#t.delete(e)}get slotNames(){return Array.from(this.#t)}slotExists(e){return this.#t.has(e)}addComponentsToSlot(e,...t){if(!this.slotExists(e)){if(this.#i)throw new Error(`Slot "${e}" does not exist`);console.warn(`Warning: Slot "${e}" does not exist in component "${this.#r.constructor.name}". It will be created automatically.`)}let r=this.#e.get(e);r||(r=new Set,this.#e.set(e,r));for(let i=0;i<t.length;i++)this.#n.add(t[i]),r.add(t[i])}removeChildComponent(e){this.#n.delete(e);for(let[t,r]of this.#e)if(r.has(e)){r.delete(e);break}}get children(){return this.#n}mountChildren(e){if(this.#r.isConnected!==!0)return;let t=e?[e]:Array.from(this.#t);if(t.some(i=>!this.#r.$internals.slotRefs[i])){if(this.#i)throw new Error(`One or more slot names do not exist in component "${this.#r.constructor.name}"`);if(this.#r.updateRefs(),t.some(s=>!this.#r.$internals.slotRefs[s])){console.warn(`One or more slot names do not exist in component "${this.#r.constructor.name}"`);return}}for(let i of t){let s=this.#e.get(i),o=this.#r.$internals.slotRefs[i];if(!(!s||!o))for(let l of s)l.isCollapsed||l.mount(o,"append")}}unmountChildren(e){let t=e?[e]:Array.from(this.#t);for(let r=0;r<t.length;r++){let i=Array.from(this.#e.get(t[r])||[]);for(let s=0;s<i.length;s++)i[s].unmount()}}};var p=class{events={};#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]};#e=!1;logErrors=!0;get isDestroyed(){return this.#e}on(e,t){if(this.#e)throw new Error("EventEmitter is destroyed");typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(t);let r=this,i=function(){r.removeListener(e,t)};return this.events[e].length==1&&this.#i("#has-listeners",e),i}#n(e,t){this.#t[e].push(t);let r=this;return function(){r.#r(e,t)}}#r(e,t){var r;typeof this.#t[e]=="object"&&(r=this.#t[e].indexOf(t),r>-1&&this.#t[e].splice(r,1))}off(e,t){return this.removeListener(e,t)}removeListener(e,t){if(!this.#e){var r;this.events[e]&&(r=this.events[e].indexOf(t),r>-1&&(this.events[e].splice(r,1),this.events[e].length==0&&this.#i("#no-listeners",e)))}}emit(e,...t){if(!this.#e&&typeof this.events[e]=="object")for(var r=this.events[e],i=r.length,s=0;s<i;s++)try{r[s].apply(this,t)}catch(o){this.#i("#listener-error",o,e,...t),this.logErrors&&console.error(`Error in listener for event "${e}":`,o)}}#i(e,...t){for(var r=this.#t[e],i=r.length,s=0;s<i;s++)try{r[s].apply(this,t)}catch(o){let l=o;if(l.cause={event:e,args:t},e==="#listener-error"){this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l);continue}e==="#has-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l),this.#i("#listener-error",l,"#has-listeners",...t)),e==="#no-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${e}":`,l),this.#i("#listener-error",l,"#no-listeners",...t))}}once(e,t){return this.on(e,function r(){this.removeListener(e,r),t.apply(this,arguments)})}waitForEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let i,s=this.on(e,()=>{t>0&&clearTimeout(i),s(),r(!0)});t>0&&(i=setTimeout(()=>{s(),r(!1)},t))})}waitForAnyEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let i,s=[],o=()=>{t>0&&clearTimeout(i),s.forEach(l=>{l()}),r(!0)};e.forEach(l=>{s.push(this.on(l,o))}),t>0&&(i=setTimeout(()=>{o(),r(!1)},t))})}clear(){this.events={}}destroy(){this.#e||(this.#e=!0,this.#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]},this.events={})}clearEventListeners(e){if(this.#e)return;(this.events[e]||[]).length>0&&(this.events[e]=[],this.#i("#no-listeners",e))}onHasEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#has-listeners",e)}onNoEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#no-listeners",e)}onListenerError(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#n("#listener-error",e)}};var _=class{constructor(){this.eventEmitter=new p,this.disconnectController=new AbortController,this.root=null,this.textUpdateFunction=null,this.textResources={},this.refs={},this.slotRefs={},this.parentComponent=null,this.parentSlotName=""}};function D(n){n.reloadText();try{n.connectedCallback()}catch(e){console.error("Error in connectedCallback:",e)}}function L(n){try{n.disconnectedCallback()}catch(e){console.error("Error in disconnectedCallback:",e)}}var x=class n{$internals=new _;#t=void 0;layout;slots;refsAnnotation;#e=null;#n=!1;slotManager=new w(this);isCollapsed=!1;constructor(){this.onConnect(D),this.onDisconnect(L)}reloadText(){this.$internals.textUpdateFunction&&this.$internals.textUpdateFunction(this)}setTextUpdateFunction(e){this.$internals.textUpdateFunction=e}#r(){this.layout&&(this.#t=this.layout,this.layout=void 0);let e=this.#t||void 0;if(e==null)return;let t;if(typeof e=="function"){let i=e(this);i instanceof Node?t=i:t=S(i)}else t=S(e);let r=0;for(let i=0;i<t.childNodes.length;i++)t.childNodes[i].nodeType===1&&r++;if(r!==1)throw new Error("Layout must have exactly one root element");this.#e=t}setLayout(e,t){this.#t=e,this.#e=null,t&&(this.refsAnnotation=t)}getRefs(){if(!this.#n)throw new Error("Component is not connected to the DOM");return this.$internals.refs}getRef(e){let t=this.getRefs();if(!(e in t))throw new Error(`Ref "${e}" does not exist`);return t[e]}hasRef(e){let t=this.getRefs();return e in t}updateRefs(){if(!this.$internals.root)throw new Error("Component is not connected to the DOM");let e=this.$internals.root,{refs:t,scope_refs:r}=b(e,null,{scope_ref_attr_name:"data-slot",ref_attr_name:"data-ref"});this.refsAnnotation&&T(t,this.refsAnnotation);for(let i in r)this.slotManager.addSlot(i);this.$internals.refs=t,this.$internals.slotRefs=r}on(e,t){return this.$internals.eventEmitter.on(e,t)}emit(e,...t){return this.$internals.eventEmitter.emit(e,this,...t)}onBeforeConnect(e){return this.on("beforeConnect",e)}onConnect(e){return this.on("connect",e)}onDisconnect(e){return this.on("disconnect",e)}onMount(e){return this.on("mount",e)}onBeforeUnmount(e){return this.on("beforeUnmount",e)}onUnmount(e){return this.on("unmount",e)}onCollapse(e){return this.on("collapse",e)}onExpand(e){return this.on("expand",e)}get isConnected(){return this.#n}connect(e){if(this.#n===!0)throw new Error("Component is already connected");this.$internals.root=e,this.updateRefs(),this.$internals.disconnectController=new AbortController,this.#n=!0,this.slotManager.mountChildren(),this.emit("connect")}disconnect(){this.#n!==!1&&(this.#n=!1,this.$internals.disconnectController.abort(),this.$internals.refs={},this.$internals.slotRefs={},this.emit("disconnect"))}connectedCallback(){}disconnectedCallback(){}mount(e,t="replace"){if(!(e instanceof Element))throw new TypeError("Container must be a DOM Element");let r=["replace","append","prepend"];if(!r.includes(t))throw new Error(`Invalid mode: ${t}. Must be one of: ${r.join(", ")}`);if(this.#e===null&&this.#r(),this.#e===null)throw new Error("Template is not set");if(this.#n===!0)return;let i=this.#e.cloneNode(!0);this.emit("beforeConnect",i);let s=i.firstElementChild;t==="replace"?e.replaceChildren(i):t==="append"?e.append(i):t==="prepend"&&e.prepend(i),this.connect(s),this.emit("mount")}unmount(){this.#n!==!1&&(this.emit("beforeUnmount"),this.slotManager.unmountChildren(),this.disconnect(),this.$internals.root?.remove(),this.emit("unmount"))}collapse(){this.unmount(),this.isCollapsed=!0,this.emit("collapse")}expand(){this.isCollapsed=!1,this.#n!==!0&&this.$internals.parentComponent!==null&&(this.$internals.parentComponent.addComponentToSlot(this.$internals.parentSlotName,this),this.emit("expand"))}show(){this.isConnected&&this.$internals.root?.classList.remove("d-none")}hide(){this.isConnected&&this.$internals.root?.classList.add("d-none")}$on(e,t,r){return e.addEventListener(t,r,{signal:this.$internals.disconnectController.signal}),()=>e.removeEventListener(t,r)}getSlotNames(){return this.slotManager.slotNames}defineSlots(...e){this.slotManager.defineSlots(...e)}addComponentToSlot(e,...t){if(!t.every(r=>r instanceof n))throw new Error("All components must be instances of Component");typeof this.slots<"u"&&this.defineSlots(...this.slots),this.slotManager.addComponentsToSlot(e,...t);for(let r=0;r<t.length;r++)t[r].$internals.parentComponent=this,t[r].$internals.parentSlotName=e;this.#n&&this.slotManager.mountChildren(e)}removeChildComponent(e){e.$internals.parentComponent===this&&(e.$internals.parentComponent=null,e.$internals.parentSlotName="",this.slotManager.removeChildComponent(e))}};var C=class{constructor(e,t,r){typeof e.slots<"u"&&(e.defineSlots(...e.slots),e.slots=void 0);for(let i=0;i<t.length;i++)if(e.slotManager.slotExists(t[i])===!1)throw new Error(`Slot ${t[i]} does not exist in component`);if(e.slotManager.slotExists(r)===!1)throw new Error(`Slot ${r} does not exist in component`);this.component=e,this.slotNames=t,this.activeSlotName=r}toggle(e){if(this.slotNames.indexOf(e)===-1)throw new Error(`Slot ${e} is not defined in SlotToggler`);if(e!=this.activeSlotName)for(let t=0;t<this.slotNames.length;t++)this.slotNames[t]==e?(this.component.slotManager.mountChildren(e),this.activeSlotName=e):this.component.slotManager.unmountChildren(this.slotNames[t])}};globalThis.hasOwnProperty("document")&&E(globalThis.document);export{x as Component,P as DOMReady,C as SlotToggler,y as Toggler,Y as copyToClipboard,M as escapeHtml,Z as fadeIn,J as fadeOut,K as formatBytes,te as formatDate,ee as formatDateTime,X as getDefaultLanguage,H as hideElements,E as injectCoreStyles,W as isDarkMode,G as removeSpinnerFromButton,z as runWithMinimumTime,j as scrollToBottom,B as scrollToTop,U as showElements,q as showSpinnerInButton,Q as sleep,k as ui_button_status_waiting_off,I as ui_button_status_waiting_off_html,F as ui_button_status_waiting_on,ne as unixtime,V as withMinimumTime};
